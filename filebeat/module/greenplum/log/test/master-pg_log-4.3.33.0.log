2020-01-29 00:00:01.606881 UTC,,,p713507,th-2019006592,,,2020-01-29 00:00:01 UTC,0,,,seg-1,,,,,"LOG","00000","connection received: host=[local]",,,,,,,0,,"postmaster.c",6841,
2020-01-29 00:00:01.607028 UTC,"gpadmin","postgres",p713507,th-2019006592,"[local]",,2020-01-29 00:00:01 UTC,0,,,seg-1,,,,,"LOG","00000","connection authorized: user=gpadmin database=postgres",,,,,,,0,,"postmaster.c",6900,
2020-01-29 00:00:01.613414 UTC,"gpadmin","postgres",p713507,th-2019006592,"[local]",,2020-01-29 00:00:01 UTC,190682061,con408754,,seg-1,,,x190682061,sx1,"LOG","00000","connection authorized: user=gpadmin database=postgres",,,,,,,0,,"postinit.c",265,
2020-01-29 00:00:01.616552 UTC,"gpadmin","postgres",p713507,th-2019006592,"[local]",,2020-01-29 00:00:01 UTC,190682062,con408754,cmd1,seg-1,,dx889919,x190682062,sx1,"LOG","00000","statement: select datname from pg_database where datname not in ('postgres', 'template0', 'template1');",,,,,,"select datname from pg_database where datname not in ('postgres', 'template0', 'template1');",0,,"postgres.c",1632,
2020-01-29 00:00:01.640393 UTC,"gpadmin","dq_data_model",p713944,th-2019006592,"[local]",,2020-01-29 00:00:01 UTC,190682065,con408755,cmd1,seg-1,,dx889920,x190682065,sx1,"LOG","00000","statement: select count(*) from pg_tables where tablename='heartbeat' and schemaname='public';",,,,,,"select count(*) from pg_tables where tablename='heartbeat' and schemaname='public';",0,,"postgres.c",1632,
2020-01-29 00:00:01.640757 UTC,"gpadmin","vds_prd",p713961,th-2019006592,"[local]",,2020-01-29 00:00:01 UTC,190682066,con408756,cmd1,seg-1,,dx889921,x190682066,sx1,"LOG","00000","statement: select version()",,,,,,"select version()",0,,"postgres.c",1632,
2020-01-29 00:00:01.650141 UTC,"gpadmin","vds_prd",p714144,th-2019006592,"[local]",,2020-01-29 00:00:01 UTC,190682070,con408757,cmd1,seg-1,,dx889922,x190682070,sx1,"LOG","00000","statement: select count(case when current_query not like '%<IDLE>%' and lower(current_query) <> 'select 1' then 1 end) active_queries from pg_stat_activity;",,,,,,"select count(case when current_query not like '%<IDLE>%' and lower(current_query) <> 'select 1' then 1 end) active_queries from pg_stat_activity;",0,,"postgres.c",1632,
2020-01-29 00:00:01.653023 UTC,"gpadmin","vds_prd",p714201,th-2019006592,"[local]",,2020-01-29 00:00:01 UTC,190682072,con408759,cmd1,seg-1,,dx889924,x190682072,sx1,"LOG","00000","statement:
SELECT procpid as w_pid, usename as w_user, 'con' || sess_id  as w_connection,
    string_agg(l_procpid,',') as l_pids,
    string_agg(l_usename,',') as l_users,
    string_agg('con' || l_sess_id,',') as l_conns,
    string_agg(l_table) as tables
from
    (
    select w.procpid, w.usename,w.sess_id,
        l.procpid as l_procpid,
        l.usename as l_usename,
        l.sess_id as l_sess_id,
        t.schemaname || '.' || t.relname as l_table
    from pg_stat_activity w
    join pg_locks l1 on w.procpid = l1.pid and not l1.granted
    join pg_locks l2 on l1.relation = l2.relation and l2.granted
    join pg_stat_activity l on l2.pid = l.procpid
    join pg_stat_user_tables t on l1.relation = t.relid
    where w.waiting
    and w.usename in ('yotta_prd','gpadmin')
    and w.procpid <> l.procpid
    group by
        1,2,3,4,5,6,7
    )xxx
group by 1,2,3
order by 1,2,3",,,,,,"
SELECT procpid as w_pid, usename as w_user, 'con' || sess_id  as w_connection,
    string_agg(l_procpid,',') as l_pids,
    string_agg(l_usename,',') as l_users,
    string_agg('con' || l_sess_id,',') as l_conns,
    string_agg(l_table) as tables
from
    (
    select w.procpid, w.usename,w.sess_id,
        l.procpid as l_procpid,
        l.usename as l_usename,
        l.sess_id as l_sess_id,
        t.schemaname || '.' || t.relname as l_table
    from pg_stat_activity w
    join pg_locks l1 on w.procpid = l1.pid and not l1.granted
    join pg_locks l2 on l1.relation = l2.relation and l2.granted
    join pg_stat_activity l on l2.pid = l.procpid
    join pg_stat_user_tables t on l1.relation = t.relid
    where w.waiting
    and w.usename in ('yotta_prd','gpadmin')
    and w.procpid <> l.procpid
    group by
        1,2,3,4,5,6,7
    )xxx
group by 1,2,3
order by 1,2,3
",0,,"postgres.c",1632,
2020-02-14 00:00:07.076297 UTC,"gpadmin","vds_prd",p751024,th1452697472,"[local]",,2020-02-14 00:00:07 UTC,193249667,con399541,cmd3,seg-1,slice1,dx853045,x193249667,sx1,"LOG","00000","statement: INSERT INTO work_schema.gp_log_work (dbid,content,role,preferred_role ,mode,status,run_time)
SELECT dbid,content,role,preferred_role,mode,status,'20200214 00:00'::timestamp FROM gp_segment_configuration UNION ALL
SELECT dbid,content,role,preferred_role,mode,status,'20200214 00:00'::timestamp FROM gp_segment_configuration UNION ALL
SELECT dbid,content,role,preferred_role,mode,status,'20200214 00:00'::timestamp FROM gp_segment_configuration;",,,,,,"INSERT INTO work_schema.gp_log_work (dbid,content,role,preferred_role ,mode,status,run_time)
SELECT dbid,content,role,preferred_role,mode,status,'20200214 00:00'::timestamp FROM gp_segment_configuration UNION ALL
SELECT dbid,content,role,preferred_role,mode,status,'20200214 00:00'::timestamp FROM gp_segment_configuration UNION ALL
SELECT dbid,content,role,preferred_role,mode,status,'20200214 00:00'::timestamp FROM gp_segment_configuration;",0,,"postgres.c",1175,
2020-02-14 03:36:44.311183 UTC,,,p7548,th1452697472,,,2020-02-14 03:36:44 UTC,0,,,seg-1,,,,,"LOG","00000","connection received: host=10.110.192.149 port=51628",,,,,,,0,,"postmaster.c",6841,
2020-02-18 18:58:03.536517 UTC,"user","db",p202744,th-968001664,"10.110.109.64","43940",2020-02-18 18:55:59 UTC,193808117,con106413,cmd229,seg-1,,dx172496,,sx5,"LOG","00000","Planner produced plan :0",,,,,"SQL statement ""select sum(pg_tot
al_relation_size('schema.superb_business_table_1_prt_20190321'))::int8 from gp_dist_random('gp_id');""
SQL statement ""select sum(pg_total_relation_size((partitionschemaname || '.' || partitiontablename)::regclass))::bigint total
         from pg_partitions p
         where upper(p.tablename) = 'SUPERB_BUSINESS_TABLE'
         and upper(p.schemaname) = 'SCHEMA'""
PL/pgSQL function ""schema.excellent_business_function"" line 48 at execute statement
SQL statement ""SELECT  schema.excellent_business_function( $1 ,  $2 ,  $3 ,  $4 ,  $5 ,  $6 , NULL, NULL, NULL)""
PL/pgSQL function ""schema.excellent_business_function"" line 12 at perform
SQL statement ""SELECT  schema.excellent_business_function( $1 ||'.'|| $2 ,  $3 ,  $4 , (clock_timestamp() -  $5 )::time without time zone,  $6 ,  $4 )""
PL/pgSQL function ""excellent_business_function"" line 629 at perform","select sum(pg_total_relation_size((partitionschemaname || '.' || partitiontablename)::regclass))::bigint total
         from pg_partitions p
         where upper(p.tablename) = 'SUPERB_BUSINESS_TABLE'
         and upper(p.schemaname) = 'SCHEMA'",0,,"planner.c",164,
 2020-02-16 01:06:40.722812 UTC,"gpadmin","vds_prd",p229972,th-968001664,"10.110.114.33","7269",2020-02-16 01:01:01 UTC,193508422,con4585,cmd1198,seg-1,,dx6338,x193508422,sx1,"ERROR","XX000","Found zero distributed xid for local xid = 66
 4578 in distributed log (dtx start time = 1, page = 162, entryno = 1026) (distributedlog.c:244)  (seg42 slice2 dtord03gpbs108p.dc.dotomi.net:40000 pid=142679) (cdbdisp.c:1322)",,,,,,"
           SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;

           -- distribute catalog table from master, so that we can avoid to gather
           CREATE TEMPORARY TABLE _tmp_master ON COMMIT DROP AS
               SELECT gp_segment_id segid, attrelid,attname FROM pg_attribute;
           SELECT attrelid,attname, exists, array_agg(segid order by segid) as segids
           FROM
           (
             SELECT ideal.*,
                    case when actual.segid is null then 'missing' else 'extra' end as exists,
                    count(*) over (partition by attrelid,attname, actual.segid is null) as subcount
             FROM (
                  SELECT segid, attrelid,attname
                  FROM(  SELECT distinct attrelid,attname FROM _tmp_master
                         UNION
                         SELECT distinct attrelid,attname FROM gp_dist_random('pg_attribute') ) all_pks,
                       ( SELECT distinct content as segid from gp_segment_configuration) all_segs
                ) ideal
                LEFT OUTER JOIN
                ( SELECT segid, attrelid,attname FROM _tmp_master
                  UNION ALL
                  SELECT gp_segment_id as segid, attrelid,attname FROM gp_dist_random('pg_attribute')
                ) actual USING (segid, attrelid,attname)
           ) missing_extra
           WHERE subcount <= (1151+2)/2.0
           GROUP BY attrelid,attname, exists;
           ",0,,"cdbdisp.c",1322,"Stack trace:
 1    0xb0d20e postgres errstart (elog.c:502)
 2    0xbe5e15 postgres cdbdisp_finishCommand (cdbdisp.c:1320)
 3    0xbe5fe8 postgres cdbdisp_handleError (cdbdisp.c:1406)
 4    0x76f7fc postgres mppExecutorCleanup (execUtils.c:2377)
 5    0x7544d5 postgres ExecutorRun (execMain.c:954)
 6    0x9a6b49 postgres PortalRun (pquery.c:1260)
 7    0x99d7dc postgres <symbol not found> (postgres.c:1825)
 8    0x9a1bf9 postgres PostgresMain (postgres.c:4788)
 9    0x8fc319 postgres <symbol not found> (postmaster.c:6672)
 10   0x8fedc0 postgres PostmasterMain (postmaster.c:7603)
 11   0x7feccf postgres main (main.c:206)
 12   0x7fb0c1c98545 libc.so.6 __libc_start_main + 0xf5
 13   0x4bef79 postgres <symbol not found> + 0x4bef79
 "
