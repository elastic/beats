description: Pipeline for parsing the Elasticsearch slow logs in JSON format.
on_failure:
- set:
    field: error.message
    value: '{{ _ingest.on_failure_message }}'
processors:
- json:
    field: message
    target_field: elasticsearch.slowlog
- pipeline:
    if: ctx.elasticsearch.slowlog.containsKey('type')
    name: '{< IngestPipeline "pipeline-json-7" >}'
- pipeline:
    if: ctx.elasticsearch.slowlog.containsKey('ecs.version')
    name: '{< IngestPipeline "pipeline-json-8" >}'

