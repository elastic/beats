[
    {
        "@timestamp": "2018-10-31T11:34:25.109Z",
        "elasticsearch.audit.layer": "rest",
        "elasticsearch.audit.origin.type": "rest",
        "elasticsearch.node.id": "DSiWcTyeThWtUXLB9J0BMw",
        "event.action": "authentication_failed",
        "event.category": "database",
        "event.dataset": "elasticsearch.audit",
        "event.kind": "event",
        "event.module": "elasticsearch",
        "event.outcome": "failure",
        "event.timezone": "-02:00",
        "fileset.name": "audit",
        "host.id": "DSiWcTyeThWtUXLB9J0BMw",
        "input.type": "log",
        "log.offset": 0,
        "message": "{\"@timestamp\":\"2018-10-31T09:34:25,109\", \"node.id\":\"DSiWcTyeThWtUXLB9J0BMw\", \"event.type\":\"rest\", \"event.action\":\"authentication_failed\", \"user.name\":\"elastic\", \"origin.type\":\"rest\", \"origin.address\":\"[::1]:61598\", \"url.path\":\"/_xpack/security/user/beats_system/_password\"}",
        "related.user": [
            "elastic"
        ],
        "service.type": "elasticsearch",
        "source.address": "[::1]:61598",
        "source.ip": "::1",
        "source.port": 61598,
        "url.original": "/_xpack/security/user/beats_system/_password",
        "user.name": "elastic"
    },
    {
        "@timestamp": "2018-10-31T11:34:25.207Z",
        "elasticsearch.audit.layer": "rest",
        "elasticsearch.audit.origin.type": "rest",
        "elasticsearch.node.id": "DSiWcTyeThWtUXLB9J0BMw",
        "event.action": "authentication_failed",
        "event.category": "database",
        "event.dataset": "elasticsearch.audit",
        "event.kind": "event",
        "event.module": "elasticsearch",
        "event.outcome": "failure",
        "event.timezone": "-02:00",
        "fileset.name": "audit",
        "host.id": "DSiWcTyeThWtUXLB9J0BMw",
        "input.type": "log",
        "log.offset": 274,
        "message": "{\"@timestamp\":\"2018-10-31T09:34:25,207\", \"node.id\":\"DSiWcTyeThWtUXLB9J0BMw\", \"event.type\":\"rest\", \"event.action\":\"authentication_failed\", \"user.name\":\"elastic\", \"origin.type\":\"rest\", \"origin.address\":\"[::1]:61599\", \"url.path\":\"/_xpack/security/user/remote_monitoring_user/_password\"}",
        "related.user": [
            "elastic"
        ],
        "service.type": "elasticsearch",
        "source.address": "[::1]:61599",
        "source.ip": "::1",
        "source.port": 61599,
        "url.original": "/_xpack/security/user/remote_monitoring_user/_password",
        "user.name": "elastic"
    },
    {
        "@timestamp": "2018-10-31T11:35:11.428Z",
        "elasticsearch.audit.action": "cluster:admin/xpack/security/realm/cache/clear",
        "elasticsearch.audit.layer": "transport",
        "elasticsearch.audit.origin.type": "local_node",
        "elasticsearch.audit.request.name": "ClearRealmCacheRequest",
        "elasticsearch.audit.user.realm": "__attach",
        "elasticsearch.audit.user.roles": [
            "superuser"
        ],
        "elasticsearch.node.id": "DSiWcTyeThWtUXLB9J0BMw",
        "event.action": "access_granted",
        "event.category": "database",
        "event.dataset": "elasticsearch.audit",
        "event.kind": "event",
        "event.module": "elasticsearch",
        "event.outcome": "success",
        "event.timezone": "-02:00",
        "fileset.name": "audit",
        "host.id": "DSiWcTyeThWtUXLB9J0BMw",
        "input.type": "log",
        "log.offset": 558,
        "message": "{\"@timestamp\":\"2018-10-31T09:35:11,428\", \"node.id\":\"DSiWcTyeThWtUXLB9J0BMw\", \"event.type\":\"transport\", \"event.action\":\"access_granted\", \"user.name\":\"_xpack_security\", \"user.realm\":\"__attach\", \"user.roles\":[\"superuser\"], \"origin.type\":\"local_node\", \"origin.address\":\"127.0.0.1:9300\", \"action\":\"cluster:admin/xpack/security/realm/cache/clear\", \"request.name\":\"ClearRealmCacheRequest\"}",
        "related.user": [
            "_xpack_security"
        ],
        "service.type": "elasticsearch",
        "source.address": "127.0.0.1:9300",
        "source.ip": "127.0.0.1",
        "source.port": 9300,
        "user.name": "_xpack_security"
    },
    {
        "@timestamp": "2018-10-31T11:35:11.430Z",
        "elasticsearch.audit.action": "cluster:admin/xpack/security/realm/cache/clear[n]",
        "elasticsearch.audit.layer": "transport",
        "elasticsearch.audit.origin.type": "local_node",
        "elasticsearch.audit.request.name": "Node",
        "elasticsearch.audit.user.realm": "__attach",
        "elasticsearch.audit.user.roles": [
            "superuser"
        ],
        "elasticsearch.node.id": "DSiWcTyeThWtUXLB9J0BMw",
        "event.action": "access_granted",
        "event.category": "database",
        "event.dataset": "elasticsearch.audit",
        "event.kind": "event",
        "event.module": "elasticsearch",
        "event.outcome": "success",
        "event.timezone": "-02:00",
        "fileset.name": "audit",
        "host.id": "DSiWcTyeThWtUXLB9J0BMw",
        "input.type": "log",
        "log.offset": 941,
        "message": "{\"@timestamp\":\"2018-10-31T09:35:11,430\", \"node.id\":\"DSiWcTyeThWtUXLB9J0BMw\", \"event.type\":\"transport\", \"event.action\":\"access_granted\", \"user.name\":\"_xpack_security\", \"user.realm\":\"__attach\", \"user.roles\":[\"superuser\"], \"origin.type\":\"local_node\", \"origin.address\":\"127.0.0.1:9300\", \"action\":\"cluster:admin/xpack/security/realm/cache/clear[n]\", \"request.name\":\"Node\"}",
        "related.user": [
            "_xpack_security"
        ],
        "service.type": "elasticsearch",
        "source.address": "127.0.0.1:9300",
        "source.ip": "127.0.0.1",
        "source.port": 9300,
        "user.name": "_xpack_security"
    },
    {
        "@timestamp": "2018-10-31T11:35:12.303Z",
        "elasticsearch.audit.action": "cluster:admin/xpack/security/user/change_password",
        "elasticsearch.audit.layer": "transport",
        "elasticsearch.audit.origin.type": "rest",
        "elasticsearch.audit.request.name": "ChangePasswordRequest",
        "elasticsearch.audit.user.realm": "reserved",
        "elasticsearch.audit.user.roles": [
            "superuser"
        ],
        "elasticsearch.node.id": "DSiWcTyeThWtUXLB9J0BMw",
        "event.action": "access_granted",
        "event.category": "database",
        "event.dataset": "elasticsearch.audit",
        "event.kind": "event",
        "event.module": "elasticsearch",
        "event.outcome": "success",
        "event.timezone": "-02:00",
        "fileset.name": "audit",
        "host.id": "DSiWcTyeThWtUXLB9J0BMw",
        "input.type": "log",
        "log.offset": 1309,
        "message": "{\"@timestamp\":\"2018-10-31T09:35:12,303\", \"node.id\":\"DSiWcTyeThWtUXLB9J0BMw\", \"event.type\":\"transport\", \"event.action\":\"access_granted\", \"user.name\":\"elastic\", \"user.realm\":\"reserved\", \"user.roles\":[\"superuser\"], \"origin.type\":\"rest\",\"origin.address\":\"[::1]:61711\", \"action\":\"cluster:admin/xpack/security/user/change_password\", \"request.name\":\"ChangePasswordRequest\"}",
        "related.user": [
            "elastic"
        ],
        "service.type": "elasticsearch",
        "source.address": "[::1]:61711",
        "source.ip": "::1",
        "source.port": 61711,
        "user.name": "elastic"
    },
    {
        "@timestamp": "2018-10-31T11:35:12.314Z",
        "elasticsearch.audit.action": "indices:admin/create",
        "elasticsearch.audit.indices": [
            ".security-6"
        ],
        "elasticsearch.audit.layer": "transport",
        "elasticsearch.audit.origin.type": "local_node",
        "elasticsearch.audit.request.name": "CreateIndexRequest",
        "elasticsearch.audit.user.realm": "__attach",
        "elasticsearch.audit.user.roles": [
            "superuser"
        ],
        "elasticsearch.node.id": "DSiWcTyeThWtUXLB9J0BMw",
        "event.action": "access_granted",
        "event.category": "database",
        "event.dataset": "elasticsearch.audit",
        "event.kind": "event",
        "event.module": "elasticsearch",
        "event.outcome": "success",
        "event.timezone": "-02:00",
        "fileset.name": "audit",
        "host.id": "DSiWcTyeThWtUXLB9J0BMw",
        "input.type": "log",
        "log.offset": 1676,
        "message": "{\"@timestamp\":\"2018-10-31T09:35:12,314\", \"node.id\":\"DSiWcTyeThWtUXLB9J0BMw\", \"event.type\":\"transport\", \"event.action\":\"access_granted\", \"user.name\":\"_xpack_security\", \"user.realm\":\"__attach\", \"user.roles\":[\"superuser\"], \"origin.type\":\"local_node\", \"origin.address\":\"127.0.0.1:9300\", \"action\":\"indices:admin/create\", \"request.name\":\"CreateIndexRequest\", \"indices\":[\".security-6\"]}",
        "related.user": [
            "_xpack_security"
        ],
        "service.type": "elasticsearch",
        "source.address": "127.0.0.1:9300",
        "source.ip": "127.0.0.1",
        "source.port": 9300,
        "user.name": "_xpack_security"
    },
    {
        "@timestamp": "2019-01-27T22:15:10.380Z",
        "elasticsearch.audit.layer": "rest",
        "elasticsearch.audit.origin.type": "rest",
        "elasticsearch.audit.realm": "default_file",
        "elasticsearch.audit.request.id": "WzL_kb6VSvOhAq0twPvHOQ",
        "elasticsearch.node.id": "y8fa3M5zSSGo1M_KJRMUXw",
        "elasticsearch.node.name": "node-0",
        "event.action": "authentication_success",
        "event.category": "database",
        "event.dataset": "elasticsearch.audit",
        "event.kind": "event",
        "event.module": "elasticsearch",
        "event.outcome": "success",
        "event.timezone": "-02:00",
        "fileset.name": "audit",
        "host.id": "y8fa3M5zSSGo1M_KJRMUXw",
        "http.request.body.content": "\n{\n    \"query\" : {\n        \"term\" : { \"user\" : \"kimchy\" }\n    }\n}\n",
        "http.request.id": "WzL_kb6VSvOhAq0twPvHOQ",
        "http.request.method": "GET",
        "http.request.mime_type": "application/json",
        "input.type": "log",
        "log.offset": 2056,
        "message": "{\"@timestamp\":\"2019-01-27T20:15:10,380\", \"node.name\":\"node-0\", \"node.id\":\"y8fa3M5zSSGo1M_KJRMUXw\", \"event.type\":\"rest\", \"event.action\":\"authentication_success\", \"user.name\":\"elastic-admin\", \"origin.type\":\"rest\", \"origin.address\":\"[::1]:58955\", \"realm\":\"default_file\", \"url.path\":\"/_search\", \"request.method\":\"GET\", \"request.body\":\"\\n{\\n    \\\"query\\\" : {\\n        \\\"term\\\" : { \\\"user\\\" : \\\"kimchy\\\" }\\n    }\\n}\\n\", \"request.id\":\"WzL_kb6VSvOhAq0twPvHOQ\"}",
        "related.user": [
            "elastic-admin"
        ],
        "service.type": "elasticsearch",
        "source.address": "[::1]:58955",
        "source.ip": "::1",
        "source.port": 58955,
        "url.original": "/_search",
        "user.name": "elastic-admin"
    },
    {
        "@timestamp": "2020-12-30T21:17:28.308Z",
        "elasticsearch.audit.layer": "security_config_change",
        "elasticsearch.audit.request.id": "qvLIgw_eTvyK3cgV-GaLVg",
        "elasticsearch.node.id": "0RMNyghkQYCc_gVd1G6tZQ",
        "event.action": "change_disable_user",
        "event.category": "database",
        "event.dataset": "elasticsearch.audit",
        "event.kind": "event",
        "event.module": "elasticsearch",
        "event.outcome": "failure",
        "fileset.name": "audit",
        "host.id": "0RMNyghkQYCc_gVd1G6tZQ",
        "http.request.id": "qvLIgw_eTvyK3cgV-GaLVg",
        "input.type": "log",
        "log.offset": 2509,
        "message": "{\"type\":\"audit\", \"timestamp\":\"2020-12-30T23:17:28,308+0200\", \"node.id\":\"0RMNyghkQYCc_gVd1G6tZQ\", \"event.type\":\"security_config_change\", \"event.action\":\"change_disable_user\", \"request.id\":\"qvLIgw_eTvyK3cgV-GaLVg\", \"change\":{\"disable\":{\"user\":{\"name\":\"user1\"}}}}",
        "related.user": [
            "user1"
        ],
        "service.type": "elasticsearch",
        "user.name": "user1"
    },
    {
        "@timestamp": "2020-12-30T21:17:34.843Z",
        "elasticsearch.audit.layer": "security_config_change",
        "elasticsearch.audit.request.id": "BO3QU3qeTb-Ei0G0rUOalQ",
        "elasticsearch.node.id": "0RMNyghkQYCc_gVd1G6tZQ",
        "event.action": "change_enable_user",
        "event.category": "database",
        "event.dataset": "elasticsearch.audit",
        "event.kind": "event",
        "event.module": "elasticsearch",
        "event.outcome": "failure",
        "fileset.name": "audit",
        "host.id": "0RMNyghkQYCc_gVd1G6tZQ",
        "http.request.id": "BO3QU3qeTb-Ei0G0rUOalQ",
        "input.type": "log",
        "log.offset": 2770,
        "message": "{\"type\":\"audit\", \"timestamp\":\"2020-12-30T23:17:34,843+0200\", \"node.id\":\"0RMNyghkQYCc_gVd1G6tZQ\", \"event.type\":\"security_config_change\", \"event.action\":\"change_enable_user\", \"request.id\":\"BO3QU3qeTb-Ei0G0rUOalQ\", \"change\":{\"enable\":{\"user\":{\"name\":\"user1\"}}}}",
        "related.user": [
            "user1"
        ],
        "service.type": "elasticsearch",
        "user.name": "user1"
    },
    {
        "@timestamp": "2020-12-30T20:19:41.345Z",
        "elasticsearch.audit.layer": "security_config_change",
        "elasticsearch.audit.request.id": "au5a1Cc3RrebDMitMGGNCw",
        "elasticsearch.node.id": "0RMNyghkQYCc_gVd1G6tZQ",
        "event.action": "delete_user",
        "event.category": "database",
        "event.dataset": "elasticsearch.audit",
        "event.kind": "event",
        "event.module": "elasticsearch",
        "event.outcome": "failure",
        "fileset.name": "audit",
        "host.id": "0RMNyghkQYCc_gVd1G6tZQ",
        "http.request.id": "au5a1Cc3RrebDMitMGGNCw",
        "input.type": "log",
        "log.offset": 3029,
        "message": "{\"type\":\"audit\", \"timestamp\":\"2020-12-30T22:19:41,345+0200\", \"node.id\":\"0RMNyghkQYCc_gVd1G6tZQ\", \"event.type\":\"security_config_change\", \"event.action\":\"delete_user\", \"request.id\":\"au5a1Cc3RrebDMitMGGNCw\", \"delete\":{\"user\":{\"name\":\"jacknich\"}}}",
        "related.user": [
            "jacknich"
        ],
        "service.type": "elasticsearch",
        "user.name": "jacknich"
    },
    {
        "@timestamp": "2020-12-30T22:36:30.247Z",
        "elasticsearch.audit.invalidate.apikeys.owned_by_authenticated_user": false,
        "elasticsearch.audit.layer": "security_config_change",
        "elasticsearch.audit.request.id": "7lyIQU9QTFqSrTxD0CqnTQ",
        "elasticsearch.audit.user.realm": "native1",
        "elasticsearch.node.id": "9clhpgjJRR-iKzOw20xBNQ",
        "event.action": "invalidate_apikeys",
        "event.category": "database",
        "event.dataset": "elasticsearch.audit",
        "event.kind": "event",
        "event.module": "elasticsearch",
        "event.outcome": "failure",
        "fileset.name": "audit",
        "host.id": "9clhpgjJRR-iKzOw20xBNQ",
        "http.request.id": "7lyIQU9QTFqSrTxD0CqnTQ",
        "input.type": "log",
        "log.offset": 3273,
        "message": "{\"type\":\"audit\", \"timestamp\":\"2020-12-31T00:36:30,247+0200\", \"node.id\":\"9clhpgjJRR-iKzOw20xBNQ\", \"event.type\":\"security_config_change\", \"event.action\":\"invalidate_apikeys\", \"request.id\":\"7lyIQU9QTFqSrTxD0CqnTQ\", \"invalidate\":{\"apikeys\":{\"owned_by_authenticated_user\":false,\"user\":{\"name\":\"myuser\",\"realm\":\"native1\"}}}}",
        "related.user": [
            "myuser"
        ],
        "service.type": "elasticsearch",
        "user.name": "myuser"
    },
    {
        "@timestamp": "2020-12-30T20:10:09.749Z",
        "elasticsearch.audit.layer": "security_config_change",
        "elasticsearch.audit.request.id": "VIiSvhp4Riim_tpkQCVSQA",
        "elasticsearch.node.id": "0RMNyghkQYCc_gVd1G6tZQ",
        "event.action": "put_user",
        "event.category": "database",
        "event.dataset": "elasticsearch.audit",
        "event.kind": "event",
        "event.module": "elasticsearch",
        "event.outcome": "failure",
        "fileset.name": "audit",
        "host.id": "0RMNyghkQYCc_gVd1G6tZQ",
        "http.request.id": "VIiSvhp4Riim_tpkQCVSQA",
        "input.type": "log",
        "log.offset": 3592,
        "message": "{\"type\":\"audit\", \"timestamp\":\"2020-12-30T22:10:09,749+0200\", \"node.id\":\"0RMNyghkQYCc_gVd1G6tZQ\", \"event.type\":\"security_config_change\", \"event.action\":\"put_user\", \"request.id\":\"VIiSvhp4Riim_tpkQCVSQA\", \"put\":{\"user\":{\"name\":\"user1\",\"enabled\":false,\"roles\":[\"admin\",\"other_role1\"],\"full_name\":\"Jack Sparrow\",\"email\":\"jack@blackpearl.com\",\"has_password\":true,\"metadata\":{\"cunning\":10}}}}",
        "related.user": [
            "user1"
        ],
        "service.type": "elasticsearch",
        "user.email": "jack@blackpearl.com",
        "user.full_name": "Jack Sparrow",
        "user.name": "user1"
    },
    {
        "@timestamp": "2020-12-30T20:49:34.859Z",
        "elasticsearch.audit.action": "indices:data/read/search",
        "elasticsearch.audit.indices": [
            "alias1"
        ],
        "elasticsearch.audit.layer": "transport",
        "elasticsearch.audit.origin.type": "rest",
        "elasticsearch.audit.request.id": "RcaSt872RG-R_WJBEGfYXA",
        "elasticsearch.audit.request.name": "SearchRequest",
        "elasticsearch.audit.user.realm": "default_native",
        "elasticsearch.audit.user.roles": [
            "test_role"
        ],
        "elasticsearch.audit.user.run_as.name": "user1",
        "elasticsearch.audit.user.run_as.realm": "default_native",
        "elasticsearch.node.id": "0RMNyghkQYCc_gVd1G6tZQ",
        "event.action": "run_as_denied",
        "event.category": "database",
        "event.dataset": "elasticsearch.audit",
        "event.kind": "event",
        "event.module": "elasticsearch",
        "event.outcome": "failure",
        "fileset.name": "audit",
        "host.id": "0RMNyghkQYCc_gVd1G6tZQ",
        "http.request.id": "RcaSt872RG-R_WJBEGfYXA",
        "input.type": "log",
        "log.offset": 3978,
        "message": "{\"type\":\"audit\", \"timestamp\":\"2020-12-30T22:49:34,859+0200\", \"node.id\":\"0RMNyghkQYCc_gVd1G6tZQ\", \"event.type\":\"transport\", \"event.action\":\"run_as_denied\", \"user.name\":\"user1\", \"user.run_as.name\":\"user1\", \"user.realm\":\"default_native\", \"user.run_as.realm\":\"default_native\", \"user.roles\":[\"test_role\"], \"origin.type\":\"rest\", \"origin.address\":\"[::1]:52662\", \"request.id\":\"RcaSt872RG-R_WJBEGfYXA\", \"action\":\"indices:data/read/search\", \"request.name\":\"SearchRequest\", \"indices\":[\"alias1\"]}",
        "related.user": [
            "user1",
            "user1"
        ],
        "service.type": "elasticsearch",
        "source.address": "[::1]:52662",
        "source.ip": "::1",
        "source.port": 52662,
        "user.effective.name": "user1",
        "user.name": "user1"
    },
    {
        "@timestamp": "2020-12-30T20:44:42.068Z",
        "elasticsearch.audit.action": "indices:data/read/search",
        "elasticsearch.audit.indices": [
            "alias1"
        ],
        "elasticsearch.audit.layer": "transport",
        "elasticsearch.audit.origin.type": "rest",
        "elasticsearch.audit.request.id": "dGqPTdEQSX2TAPS3cvc1qA",
        "elasticsearch.audit.request.name": "SearchRequest",
        "elasticsearch.audit.user.realm": "reserved",
        "elasticsearch.audit.user.roles": [
            "superuser"
        ],
        "elasticsearch.audit.user.run_as.name": "user1",
        "elasticsearch.audit.user.run_as.realm": "default_native",
        "elasticsearch.node.id": "0RMNyghkQYCc_gVd1G6tZQ",
        "event.action": "run_as_granted",
        "event.category": "database",
        "event.dataset": "elasticsearch.audit",
        "event.kind": "event",
        "event.module": "elasticsearch",
        "event.outcome": "success",
        "fileset.name": "audit",
        "host.id": "0RMNyghkQYCc_gVd1G6tZQ",
        "http.request.id": "dGqPTdEQSX2TAPS3cvc1qA",
        "input.type": "log",
        "log.offset": 4463,
        "message": "{\"type\":\"audit\", \"timestamp\":\"2020-12-30T22:44:42,068+0200\", \"node.id\":\"0RMNyghkQYCc_gVd1G6tZQ\", \"event.type\":\"transport\", \"event.action\":\"run_as_granted\", \"user.name\":\"elastic\", \"user.run_as.name\":\"user1\", \"user.realm\":\"reserved\", \"user.run_as.realm\":\"default_native\", \"user.roles\":[\"superuser\"], \"origin.type\":\"rest\", \"origin.address\":\"[::1]:52623\", \"request.id\":\"dGqPTdEQSX2TAPS3cvc1qA\", \"action\":\"indices:data/read/search\", \"request.name\":\"SearchRequest\", \"indices\":[\"alias1\"]}",
        "related.user": [
            "elastic",
            "user1"
        ],
        "service.type": "elasticsearch",
        "source.address": "[::1]:52623",
        "source.ip": "::1",
        "source.port": 52623,
        "user.effective.name": "user1",
        "user.name": "elastic"
    }
]