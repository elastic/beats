type: system-logs
{{ if .use_journald }}
use_journald: true
{{ end }}

{{ if .use_files }}
use_files: true
{{ end }}

journald:
  id: system-auth
  facilities:
    - 4
    - 10
  tags: {{ append .tags "journald" "auth" | tojson }}

files:
  id: system-auth
  paths:
  {{ range $i, $path := .paths }}
    - {{$path}}
  {{ end }}
  exclude_files: [".gz$"]

  multiline:
    pattern: "^\\s"
    match: after

  processors:
    - add_locale: ~

  tags: {{ .tags | tojson }}

  publisher_pipeline.disable_host: {{ inList .tags "forwarded" }}
