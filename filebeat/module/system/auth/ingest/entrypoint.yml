description: Entrypoint Pipeline for system/auth Filebeat module
processors:
  - script:
      source: |
              Collection tags = ctx?.tags;
              if(tags != null){
                for (String tag : tags) {
                  if (tag.toLowerCase().equals('journald')) {
                    ctx['auth_pipeline'] = '{< IngestPipeline "journald" >}';
                    return
                  }
                }
              }
              ctx['auth_pipeline'] = '{< IngestPipeline "files" >}';
              return;
  - pipeline:
      name: "{{ auth_pipeline }}"
  - remove:
      ignore_failure: true
      field: "auth_pipeline"
