This is the `replstatus` metricset of the module mongodb.

It requires the following privileges:

- https://docs.mongodb.com/manual/reference/privilege-actions/#find[`find`/`listCollections` action] on https://docs.mongodb.com/manual/reference/local-database/[the `local` database resource]
- https://docs.mongodb.com/manual/reference/privilege-actions/#collStats[`collStats` action] on https://docs.mongodb.com/manual/reference/local-database/#local.oplog.rs[the `local.oplog.rs` collection resource]
- https://docs.mongodb.com/manual/reference/privilege-actions/#replSetGetStatus[`replSetGetStatus` action] on https://docs.mongodb.com/manual/reference/resource-document/#cluster-resource[`cluster` resource]

In Mongo shell, you can use the following command to create the role

....
db.createRole(
   {
     role: "replstatusRole",
     privileges: [
       { resource: { db: "local" }, actions: ["listCollections"] },
       { resource: { db: "local", collection: "oplog.rs" }, actions: ["collStats"] },
       { resource: { cluster: true }, actions: ["replSetGetStatus"] },
     ],
     roles: []
   }
)
....

You can then use the following command to create the privileged user

....
db.createUser(
    {
        user: "beats",
        pwd: "pass",
        roles: ["replstatusRole"]
    }
)
....

or grant the role to an existing user

....
db.grantRolesToUser(
    "user",
    ["replstatusRole"]
)
....
