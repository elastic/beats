name: Journalbeat
cmd: journalbeat
rules:
- filter_values:
    selector: streams
    key: type
    values:
    - log/journal
- copy:
    from: streams
    to: journalbeat
- rename:
    from: journalbeat.streams
    to: inputs
- filter:
    selectors:
    - journalbeat
    - output
    - keystore
- rename:
    from: output.elasticsearch.url
    to: hosts
when: HasItems(%{[journalbeat.inputs]}) && HasNamespace('output', 'elasticsearch',
  'redis', 'kafka', 'logstash')
