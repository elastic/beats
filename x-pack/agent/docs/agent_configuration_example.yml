outputs:
  default:
    api_key: VuaCfGcBCdbkQm-e5aOx:ui2lp2axTNmsyakw9tvNnw
    hosts: ["localhost:9200"]
    ca_sha256: "7lHLiyp4J8m9kw38SJ7SURJP4bXRZv/BNxyyXkCcE/M="
    # Not supported at first
    queue:
      type: disk

  long_term_storage:
    api_key: VuaCfGcBCdbkQm-e5aOx:ui2lp2axTNmsyakw9tvNnw
    hosts: ["localhost:9200"]
    ca_sha256: "7lHLiyp4J8m9kw38SJ7SURJP4bXRZv/BNxyyXkCcE/M="
    queue:
      type: disk

  monitoring:
    api_key: VuaCfGcBCdbkQm-e5aOx:ui2lp2axTNmsyakw9tvNnw
    hosts: ["localhost:9200"]
    ca_sha256: "7lHLiyp4J8m9kw38SJ7SURJP4bXRZv/BNxyyXkCcE/M="

settings.monitoring:
  use_output: monitoring

datasources:
  # use the nginx package
  - id?: nginx-x1
    title?: "This is a nice title for human"
    # Package this config group is coming from. On importing, we know where it belongs
    # The package tells the UI which application to link to
    package?:
      name: epm/nginx
      version: 1.7.0
    namespace?: prod
    constraints?:
      # Contraints look are not final
      - os.platform: { in: "windows" }
      - agent.version: { ">=": "8.0.0" }
    use_output: long_term_storage
    inputs:
      - type: logs
        processors?:
        streams:
          - id?: {id}
            dataset: nginx.acccess
            paths: /var/log/nginx/access.log
          - id?: {id}
            dataset: nginx.error
            paths: /var/log/nginx/error.log
      - type: metrics/nginx
        streams:
          - id?: {id}
            dataset: nginx.stub_status
            metricset: stub_status

  #################################################################################################
  # Custom Kafka datasource
  - id: kafka-x1
    title: "Consume data from kafka"
    namespace?: prod
    use_output: long_term_storage
    inputs:
      - type: kafka
        host: localhost:6566
        streams:
          - dataset: foo.dataset
            topic: foo
            processors:
             - extract_bro_specifics


  #################################################################################################
  # System EPM package
  - id?: system
    title: Collect system information and metrics
    package:
      name: epm/system
      version: 1.7.0
    inputs:
      - type: metrics/system
        streams:
         - id?: {id}
           enabled?: false # default true
           metricset: cpu
           period: 10s
           dataset: system.cpu
           metrics: ["percentages", "normalized_percentages"]
         - metricset: memory
           dataset: system.memory
         - metricset: diskio
           dataset: system.diskio
         - metricset: load
           dataset: system.load
         - metricset: memory
           dataset: system.memory
         - metricset: process
           dataset: system.process
           processes: ["firefox*"]
         - metricset: process_summary
           dataset: system.process_summary
         - metricset: uptime
           dataset: system.uptime
         - metricset: socket_summary
           dataset: system.socket_summary
         - metricset: filesystem
           dataset: system.filesystem
         - metricset: raid
           dataset: system.raid
         - metricset: socket
           dataset: system.socket
         - metricset: service
           dataset: system.service
         - metricset: fsstat
           dataset: system.fsstat
         - metricset: foo
           dataset: system.foo

#################################################################################################
### suggestion 1
 - id?: myendpoint-x1
   title: Endpoint configuration
   package:
     name: endpoint
     version: xxx
   inputs:
     - type: endpoint # Reserved key word
       streams:
         - type: malware
           detect: true
           prevent: false
           notify_user: false
           threshold: recommended
           platform: windows

        - type: eventing
          api: true
          clr: false
          dll_and_driver_load: false
          dns: true
          file: false
          platform: windows

       - type: malware
         detect: true
         prevent: false
         notify_user: false
         threshold: recommended
         platform: mac

      - type: eventing
        api: true
        clr: false
        dll_and_driver_load: false
        dns: true
        file: false
        platform: mac

       - type: malware
         detect: true
         prevent: false
         notify_user: false
         threshold: recommended
         platform: linux

      - type: eventing
        api: true
        clr: false
        dll_and_driver_load: false
        dns: true
        file: false
        platform: linux

#################################################################################################
### suggestion 2
 - id?: myendpoint-1
   title: Endpoint configuration
   package:
     name: epm/endpoint # This establish the link with the package and will allow to link it to endpoint app.
     version: xxx
   inputs:
     - type: endpoint # Reserved key word
       windows:
            eventing:
                api: true
                clr: false
                dll_and_driver_load: false
                dns: true
                 ...
                file: false
            malware:
                detect: true
                prevent: false
                notify_user: false
                threshold: recommended
        mac:
            eventing:
                file: true
                network: false
                process: false
                ...
            malware:
               detect: true
               prevent: false
               notify_user: false
               threshold: recommended
         linux:
            eventing:
                file: true
                network: false
                process: false
