// Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one
// or more contributor license agreements. Licensed under the Elastic License;
// you may not use this file except in compliance with the Elastic License.

//go:build windows

package parsers

import (
	"testing"
)

func TestParseShellItem(t *testing.T) {

	type testCase struct {
		data         []byte
		expectedType ShellItemType
	}

	tests := []testCase{
		{
			data: []byte{
				0x1f, 0x44, 0x47, 0x1a, 0x03, 0x59, 0x72, 0x3f, 0xa7, 0x44, 0x89, 0xc5, 0x55, 0x95, 0xfe, 0x6b,
				0x30, 0xee, 0x26, 0x00, 0x01, 0x00, 0x26, 0x00, 0xef, 0xbe, 0x10, 0x00, 0x00, 0x00, 0x1b, 0x9d,
				0x8a, 0x47, 0x08, 0x25, 0xd9, 0x01, 0x08, 0xd0, 0x16, 0x63, 0xb1, 0x68, 0xd9, 0x01, 0xfb, 0xc6,
				0x7d, 0xd2, 0xbd, 0x68, 0xd9, 0x01, 0x14, 0x00,
			},
			expectedType: ShellItemTypeRootFolder,
		},
		{
			data: []byte{
				0x31, 0x00, 0x00, 0x00, 0x00, 0x00, 0x2b, 0x56, 0xe7, 0xa9, 0x10, 0x00, 0x52, 0x6f, 0x61, 0x6d,
				0x69, 0x6e, 0x67, 0x00, 0x40, 0x00, 0x09, 0x00, 0x04, 0x00, 0xef, 0xbe, 0x2a, 0x56, 0xa4, 0x7b,
				0x86, 0x56, 0xd7, 0x93, 0x2e, 0x00, 0x00, 0x00, 0xc0, 0xda, 0x01, 0x00, 0x00, 0x00, 0x03, 0x00,
				0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x37, 0x7e,
				0xfa, 0x00, 0x52, 0x00, 0x6f, 0x00, 0x61, 0x00, 0x6d, 0x00, 0x69, 0x00, 0x6e, 0x00, 0x67, 0x00,
				0x00, 0x00, 0x16, 0x00,
			},
			expectedType: ShellItemTypeDirectory,
		},
	}
	t.Run("TestParseShellItem", func(t *testing.T) {
		for index, test := range tests {
			shellItem := ShellItem{Data: test.data}
			if shellItem.Type() != test.expectedType {
				t.Errorf("ShellItem[%d]: Expected type %s, got %s", index, test.expectedType, shellItem.Type())
			}
			if shellItem.Size() != len(test.data) {
				t.Errorf("ShellItem[%d]: Expected size %d, got %d", index, len(test.data), shellItem.Size())
			}
		}
	})
}
