// Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one
// or more contributor license agreements. Licensed under the Elastic License;
// you may not use this file except in compliance with the Elastic License.

// Code generated by gentables. DO NOT EDIT.
// Source: gentables - static registry of windows tables

//go:build windows

package generated

import (
	_ "github.com/elastic/beats/v7/x-pack/osquerybeat/ext/osquery-extension/pkg/amcache"
	_ "github.com/elastic/beats/v7/x-pack/osquerybeat/ext/osquery-extension/pkg/browserhistory"

	"github.com/osquery/osquery-go"
	"github.com/osquery/osquery-go/plugin/table"

	"github.com/elastic/beats/v7/x-pack/osquerybeat/ext/osquery-extension/pkg/logger"
	elasticamcacheapplication "github.com/elastic/beats/v7/x-pack/osquerybeat/ext/osquery-extension/pkg/tables/generated/amcache/elastic_amcache_application"
	elasticamcacheapplicationfile "github.com/elastic/beats/v7/x-pack/osquerybeat/ext/osquery-extension/pkg/tables/generated/amcache/elastic_amcache_application_file"
	elasticamcacheapplicationshortcut "github.com/elastic/beats/v7/x-pack/osquerybeat/ext/osquery-extension/pkg/tables/generated/amcache/elastic_amcache_application_shortcut"
	elasticamcachedevicepnp "github.com/elastic/beats/v7/x-pack/osquerybeat/ext/osquery-extension/pkg/tables/generated/amcache/elastic_amcache_device_pnp"
	elasticamcachedriverbinary "github.com/elastic/beats/v7/x-pack/osquerybeat/ext/osquery-extension/pkg/tables/generated/amcache/elastic_amcache_driver_binary"
	elasticamcachedriverpackage "github.com/elastic/beats/v7/x-pack/osquerybeat/ext/osquery-extension/pkg/tables/generated/amcache/elastic_amcache_driver_package"
	elasticbrowserhistory "github.com/elastic/beats/v7/x-pack/osquerybeat/ext/osquery-extension/pkg/tables/generated/elastic_browser_history"
)

// RegisterTables registers all generated tables with the osquery extension server.
// This function is called from main.go after all init() functions have run.
func RegisterTables(server *osquery.ExtensionManagerServer, log *logger.Logger) {
	{
		// Windows Amcache inventory application entries (Root\InventoryApplication)
		genFunc, err := elasticamcacheapplication.GetGenerateFunc(log)
		if err != nil {
			log.Errorf("Failed to get generate function for elastic_amcache_application: %v", err)
		} else {
			server.RegisterPlugin(table.NewPlugin("elastic_amcache_application", elasticamcacheapplication.Columns(), genFunc))
			log.Infof("Registered table: elastic_amcache_application")
		}
	}
	{
		// Windows Amcache inventory application file entries (Root\InventoryApplicationFile)
		genFunc, err := elasticamcacheapplicationfile.GetGenerateFunc(log)
		if err != nil {
			log.Errorf("Failed to get generate function for elastic_amcache_application_file: %v", err)
		} else {
			server.RegisterPlugin(table.NewPlugin("elastic_amcache_application_file", elasticamcacheapplicationfile.Columns(), genFunc))
			log.Infof("Registered table: elastic_amcache_application_file")
		}
	}
	{
		// Windows Amcache inventory application shortcut entries (Root\InventoryApplicationShortcut)
		genFunc, err := elasticamcacheapplicationshortcut.GetGenerateFunc(log)
		if err != nil {
			log.Errorf("Failed to get generate function for elastic_amcache_application_shortcut: %v", err)
		} else {
			server.RegisterPlugin(table.NewPlugin("elastic_amcache_application_shortcut", elasticamcacheapplicationshortcut.Columns(), genFunc))
			log.Infof("Registered table: elastic_amcache_application_shortcut")
		}
	}
	{
		// Windows Amcache inventory device PnP entries (Root\InventoryDevicePnp)
		genFunc, err := elasticamcachedevicepnp.GetGenerateFunc(log)
		if err != nil {
			log.Errorf("Failed to get generate function for elastic_amcache_device_pnp: %v", err)
		} else {
			server.RegisterPlugin(table.NewPlugin("elastic_amcache_device_pnp", elasticamcachedevicepnp.Columns(), genFunc))
			log.Infof("Registered table: elastic_amcache_device_pnp")
		}
	}
	{
		// Windows Amcache inventory driver binary entries (Root\InventoryDriverBinary)
		genFunc, err := elasticamcachedriverbinary.GetGenerateFunc(log)
		if err != nil {
			log.Errorf("Failed to get generate function for elastic_amcache_driver_binary: %v", err)
		} else {
			server.RegisterPlugin(table.NewPlugin("elastic_amcache_driver_binary", elasticamcachedriverbinary.Columns(), genFunc))
			log.Infof("Registered table: elastic_amcache_driver_binary")
		}
	}
	{
		// Windows Amcache inventory driver package entries (Root\InventoryDriverPackage)
		genFunc, err := elasticamcachedriverpackage.GetGenerateFunc(log)
		if err != nil {
			log.Errorf("Failed to get generate function for elastic_amcache_driver_package: %v", err)
		} else {
			server.RegisterPlugin(table.NewPlugin("elastic_amcache_driver_package", elasticamcachedriverpackage.Columns(), genFunc))
			log.Infof("Registered table: elastic_amcache_driver_package")
		}
	}
	{
		// Browser history from multiple browsers (Chrome, Edge, Firefox, Safari) with unified schema
		genFunc, err := elasticbrowserhistory.GetGenerateFunc(log)
		if err != nil {
			log.Errorf("Failed to get generate function for elastic_browser_history: %v", err)
		} else {
			server.RegisterPlugin(table.NewPlugin("elastic_browser_history", elasticbrowserhistory.Columns(), genFunc))
			log.Infof("Registered table: elastic_browser_history")
		}
	}
}
