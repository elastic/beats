// Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one
// or more contributor license agreements. Licensed under the Elastic License;
// you may not use this file except in compliance with the Elastic License.

// Code generated by gentables. DO NOT EDIT.
// Source: gentables - static registry of linux tables

//go:build linux

package generated

import (
	_ "github.com/elastic/beats/v7/x-pack/osquerybeat/ext/osquery-extension/pkg/browserhistory"
	_ "github.com/elastic/beats/v7/x-pack/osquerybeat/ext/osquery-extension/pkg/hostgroups"
	_ "github.com/elastic/beats/v7/x-pack/osquerybeat/ext/osquery-extension/pkg/hostprocesses"
	_ "github.com/elastic/beats/v7/x-pack/osquerybeat/ext/osquery-extension/pkg/hostusers"

	"github.com/osquery/osquery-go"
	"github.com/osquery/osquery-go/plugin/table"

	"github.com/elastic/beats/v7/x-pack/osquerybeat/ext/osquery-extension/pkg/logger"
	elasticbrowserhistory "github.com/elastic/beats/v7/x-pack/osquerybeat/ext/osquery-extension/pkg/tables/generated/elastic_browser_history"
	elastichostgroups "github.com/elastic/beats/v7/x-pack/osquerybeat/ext/osquery-extension/pkg/tables/generated/elastic_host_groups"
	elastichostprocesses "github.com/elastic/beats/v7/x-pack/osquerybeat/ext/osquery-extension/pkg/tables/generated/elastic_host_processes"
	elastichostusers "github.com/elastic/beats/v7/x-pack/osquerybeat/ext/osquery-extension/pkg/tables/generated/elastic_host_users"
)

// RegisterTables registers all generated tables with the osquery extension server.
// This function is called from main.go after all init() functions have run.
func RegisterTables(server *osquery.ExtensionManagerServer, log *logger.Logger) {
	{
		// Browser history from multiple browsers (Chrome, Edge, Firefox, Safari) with unified schema
		genFunc, err := elasticbrowserhistory.GetGenerateFunc(log)
		if err != nil {
			log.Errorf("Failed to get generate function for elastic_browser_history: %v", err)
		} else {
			server.RegisterPlugin(table.NewPlugin("elastic_browser_history", elasticbrowserhistory.Columns(), genFunc))
			log.Infof("Registered table: elastic_browser_history")
		}
	}
	{
		// Host system group information from /etc/group (e.g. when running in a container with hostfs mounted)
		genFunc, err := elastichostgroups.GetGenerateFunc(log)
		if err != nil {
			log.Errorf("Failed to get generate function for elastic_host_groups: %v", err)
		} else {
			server.RegisterPlugin(table.NewPlugin("elastic_host_groups", elastichostgroups.Columns(), genFunc))
			log.Infof("Registered table: elastic_host_groups")
		}
	}
	{
		// Host system running processes from /proc (e.g. when running in a container with hostfs mounted)
		genFunc, err := elastichostprocesses.GetGenerateFunc(log)
		if err != nil {
			log.Errorf("Failed to get generate function for elastic_host_processes: %v", err)
		} else {
			server.RegisterPlugin(table.NewPlugin("elastic_host_processes", elastichostprocesses.Columns(), genFunc))
			log.Infof("Registered table: elastic_host_processes")
		}
	}
	{
		// Host system user account information from /etc/passwd (e.g. when running in a container with hostfs mounted)
		genFunc, err := elastichostusers.GetGenerateFunc(log)
		if err != nil {
			log.Errorf("Failed to get generate function for elastic_host_users: %v", err)
		} else {
			server.RegisterPlugin(table.NewPlugin("elastic_host_users", elastichostusers.Columns(), genFunc))
			log.Infof("Registered table: elastic_host_users")
		}
	}
}
