type: table
name: sample_jumplists
description: Windows Jump Lists containing recently accessed files and pinned items
platforms:
  - windows
group: jumplists

implementation_package: github.com/elastic/beats/v7/x-pack/osquerybeat/ext/osquery-extension/pkg/sampleimpl

# Reference shared types from shared_types.yaml
# These will be merged into shared embedded types during loading
shared_types:
  - ApplicationID
  - UserProfile
  - LnkMetadata
  - JumplistMeta

columns:
  # Shared types (from shared_types.yaml)
  - name: ApplicationID
    type: EMBEDDED
    shared_type: ApplicationID

  - name: UserProfile
    type: EMBEDDED
    shared_type: UserProfile

  - name: LnkMetadata
    type: EMBEDDED
    shared_type: LnkMetadata

  # Shared types (from shared_types.yaml)
  - name: JumplistMeta
    type: EMBEDDED
    shared_type: JumplistMeta

  # Regular columns
  - name: entry_index
    type: INTEGER
    description: Index of the entry within the jumplist

documentation:
  description: |
    Windows Jump Lists are a feature that provides quick access to recently
    accessed files and common tasks for applications. This table parses both
    custom destinations (pinned items) and automatic destinations (recent items).
    
    Jump lists are stored per-user in the Recent folder and contain embedded
    LNK (shortcut) file data with rich forensic information.

  examples:
    - title: Find all jumplist entries for a specific application
      query: |
        SELECT application_name, local_path, username, jumplist_type
        FROM sample_jumplists
        WHERE application_id = '590aee7bdd69b59b';

    - title: List recent file accesses by user
      query: |
        SELECT username, application_name, local_path, source_file_path
        FROM sample_jumplists
        ORDER BY username, application_name;

  notes:
    - Uses shared types from shared_types.yaml for ApplicationID, UserProfile, and LnkMetadata
    - Custom destinations contain user-pinned items
    - Automatic destinations contain recently accessed files
