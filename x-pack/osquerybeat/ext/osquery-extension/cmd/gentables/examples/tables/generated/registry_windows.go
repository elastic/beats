// Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one
// or more contributor license agreements. Licensed under the Elastic License;
// you may not use this file except in compliance with the Elastic License.

// Code generated by gentables. DO NOT EDIT.
// Source: gentables - static registry of windows tables

//go:build windows

package generated

import (
	_ "github.com/elastic/beats/v7/x-pack/osquerybeat/ext/osquery-extension/pkg/sampleimpl"

	"github.com/osquery/osquery-go"
	"github.com/osquery/osquery-go/plugin/table"

	"github.com/elastic/beats/v7/x-pack/osquerybeat/ext/osquery-extension/pkg/logger"
	samplejumplists "github.com/elastic/beats/v7/x-pack/osquerybeat/ext/osquery-extension/pkg/tables/generated/jumplists/sample_jumplists"
	samplerecentfiles "github.com/elastic/beats/v7/x-pack/osquerybeat/ext/osquery-extension/pkg/tables/generated/jumplists/sample_recent_files"
	samplecustomtable "github.com/elastic/beats/v7/x-pack/osquerybeat/ext/osquery-extension/pkg/tables/generated/sample_custom_table"
)

// RegisterTables registers all generated tables with the osquery extension server.
// This function is called from main.go after all init() functions have run.
func RegisterTables(server *osquery.ExtensionManagerServer, log *logger.Logger) {
	{
		// Example table showing the generator capabilities with multiple data types
		genFunc, err := samplecustomtable.GetGenerateFunc(log)
		if err != nil {
			log.Errorf("Failed to get generate function for sample_custom_table: %v", err)
		} else {
			server.RegisterPlugin(table.NewPlugin("sample_custom_table", samplecustomtable.Columns(), genFunc))
			log.Infof("Registered table: sample_custom_table")
		}
	}
	{
		// Windows Jump Lists containing recently accessed files and pinned items
		genFunc, err := samplejumplists.GetGenerateFunc(log)
		if err != nil {
			log.Errorf("Failed to get generate function for sample_jumplists: %v", err)
		} else {
			server.RegisterPlugin(table.NewPlugin("sample_jumplists", samplejumplists.Columns(), genFunc))
			log.Infof("Registered table: sample_jumplists")
		}
	}
	{
		// Windows Recent Files tracking user file access history
		genFunc, err := samplerecentfiles.GetGenerateFunc(log)
		if err != nil {
			log.Errorf("Failed to get generate function for sample_recent_files: %v", err)
		} else {
			server.RegisterPlugin(table.NewPlugin("sample_recent_files", samplerecentfiles.Columns(), genFunc))
			log.Infof("Registered table: sample_recent_files")
		}
	}
}
