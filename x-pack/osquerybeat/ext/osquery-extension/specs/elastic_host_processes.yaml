type: table
name: elastic_host_processes
description: Host system running processes from /proc (e.g. when running in a container with hostfs mounted)
platforms:
  - linux

implementation_package: github.com/elastic/beats/v7/x-pack/osquerybeat/ext/osquery-extension/pkg/hostprocesses

columns:
  - name: pid
    type: BIGINT
    description: Process (or thread) ID
  - name: name
    type: TEXT
    description: The process path or shorthand argv[0]
  - name: path
    type: TEXT
    description: Path to executed binary
  - name: cmdline
    type: TEXT
    description: Complete argv (command line arguments)
  - name: state
    type: TEXT
    description: Process state (R=running, S=sleeping, D=disk sleep, Z=zombie, T=stopped)
  - name: cwd
    type: TEXT
    description: Process current working directory
  - name: root
    type: TEXT
    description: Process virtual root directory
  - name: uid
    type: BIGINT
    description: Unsigned user ID (real UID)
  - name: gid
    type: BIGINT
    description: Unsigned group ID (real GID)
  - name: euid
    type: BIGINT
    description: Unsigned effective user ID
  - name: egid
    type: BIGINT
    description: Unsigned effective group ID
  - name: suid
    type: BIGINT
    description: Unsigned saved user ID
  - name: sgid
    type: BIGINT
    description: Unsigned saved group ID
  - name: on_disk
    type: INTEGER
    description: The process path exists; yes=1, no=0, unknown=-1
  - name: wired_size
    type: BIGINT
    description: Bytes of unpageable memory (always 0 on Linux)
  - name: resident_size
    type: BIGINT
    description: Bytes of private memory used by process (RSS)
  - name: total_size
    type: BIGINT
    description: Total virtual memory size
  - name: user_time
    type: BIGINT
    description: CPU time in milliseconds spent in user space
  - name: system_time
    type: BIGINT
    description: CPU time in milliseconds spent in kernel space
  - name: disk_bytes_read
    type: BIGINT
    description: Bytes read from disk
  - name: disk_bytes_written
    type: BIGINT
    description: Bytes written to disk
  - name: start_time
    type: BIGINT
    description: Process start time in seconds since Epoch, or -1 if error
  - name: parent
    type: BIGINT
    description: Process parent's PID (PPID)
  - name: pgroup
    type: BIGINT
    description: Process group ID
  - name: threads
    type: INTEGER
    description: Number of threads used by process
  - name: nice
    type: INTEGER
    description: Process nice level (-20 to 20, default 0)

documentation:
  description: |
    Query running process information from the host system when running in a container.
    Reads from the host's /proc via hostfs (default /hostfs); set ELASTIC_OSQUERY_HOSTFS to override.
    Use for container security monitoring, host process auditing, and forensics.
  examples:
    - title: Get all host processes
      query: |
        SELECT pid, name, cmdline FROM elastic_host_processes;
    - title: Find process by PID
      query: |
        SELECT * FROM elastic_host_processes WHERE pid = 1;
    - title: Find processes running as root
      query: |
        SELECT pid, name, uid, cmdline FROM elastic_host_processes WHERE uid = 0;
  notes:
    - "Linux only. Requires host /proc (or root) mounted (e.g. -v /:/hostfs:ro or -v /proc:/hostfs/proc:ro)."
    - "Use ELASTIC_OSQUERY_HOSTFS to override the hostfs root (default /hostfs)."
  related_tables:
    - elastic_host_users
    - processes
