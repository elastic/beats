[role="xpack"]

:type: entity-analytics

[id="{beatname_lc}-input-{type}"]
=== Entity Analytics Input

++++
<titleabbrev>Entity Analytics</titleabbrev>
++++

experimental[]

The Entity Analytics input collects identity assets, such as users, from external
identity providers.

The following identity providers are supported:

- <<provider-azure_ad>>

==== Configuration options

The `entity-analytics` input supports the following configuration options plus the
<<{beatname_lc}-input-{type}-common-options>> described later.

[float]
==== `provider`

The identity provider. Must be one of: `azure_ad`.

[id="{beatname_lc}-input-{type}-common-options"]
include::../../../../filebeat/docs/inputs/input-common-options.asciidoc[]

==== Providers

[id="provider-azure_ad"]
==== Azure Active Directory (`azure_ad`)

The `azure_ad` provider allows the input to retrieve users, with group
memberships, from Azure Active Directory (AD).

==== Setup

The necessary API permissions need to be granted in Azure in order for the provider to function properly:

|===
|Permission |Type

|GroupMember.Read.All
|Application

|User.Read.All
|Application
|===

For a full guide on how to set up the necessary App Registration, permission
granting, and secret configuration, follow this https://learn.microsoft.com/en-us/graph/auth-v2-service[guide].

==== Configuration

Example configuration:

["source","yaml",subs="attributes"]
----
{beatname_lc}.inputs:
- type: entity-analytics
  enabled: true
  id: azure-1
  provider: azure_ad
  sync_interval: "12h"
  update_interval: "30m"
  client_id: "CLIENT_ID"
  tenant_id: "TENANT_ID"
  secret: "SECRET"
----

The `azure_ad` provider supports the following configuration:

==== `tenant_id`

The Tenant ID. Field is required.

==== `client_id`

The client/application ID. Used for authentication. Field is required.

==== `secret`

The secret value, used for authentication. Field is required.

==== `sync_interval`

The interval in which full synchronizations should occur. The interval must be
longer than the update interval (`update_interval`) Expressed as a duration
string (e.g., 1m, 3h, 24h). Defaults to `24h` (24 hours).

==== `update_interval`

The interval in which incremental updates should occur. The interval must be
shorter than the full synchronization interval (`sync_interval`). Expressed as a
duration string (e.g., 1m, 3h, 24h). Defaults to `15m` (15 minutes).

==== `login_endpoint`

Override the default authentication login endpoint. Only change if directed to do
so. Altering this value will also require a change to `login_scopes`.

==== `login_scopes`

Override the default authentication scopes. Only change if directed to do so.

[float]
=== Metrics

This input exposes metrics under the <<http-endpoint, HTTP monitoring endpoint>>.
These metrics are exposed under the `/inputs` path. They can be used to
observe the activity of the input.

[options="header"]
|=======
| Metric                   | Description
| `sync_total`             | The total number of full synchronizations.
| `sync_error`             | The number of full synchronizations that failed due to an error.
| `sync_processing_time`   | Histogram of the elapsed full synchronizations times in nanoseconds (time of API contact to items sent to output).
| `update_total`           | The total number of incremental updates.
| `update_error`           | The number of incremental updates that failed due to an error.
| `update_processing_time` | Histogram of the elapsed incremental updates times in nanoseconds (time of API contact to items sent to output).
|=======

NOTE: This input is experimental and is under active developement. Configuration
options and behaviors may change without warning. Use with caution and do not use
in production environments.

:type!:
