# Module: googlecloud
# Docs: https://www.elastic.co/guide/en/beats/filebeat/7.6/filebeat-module-googlecloud.html

- module: googlecloud
  vpcflow:
    enabled: true

    # Google Cloud project ID.
    var.project_id: my-gcp-project-id

    # Google Pub/Sub topic containing VPC flow logs. Stackdriver must be
    # configured to use this topic as a sink for VPC flow logs.
    var.topic: googlecloud-vpc-flowlogs

    # Google Pub/Sub subscription for the topic. Filebeat will create this
    # subscription if it does not exist.
    var.subscription_name: filebeat-googlecloud-vpc-flowlogs-sub

    # Credentials file for the service account with authorization to read from
    # the subscription.
    var.credentials_file: ${path.config}/gcp-service-account-xyz.json

<<<<<<< HEAD
  audit:
=======
  firewall:
>>>>>>> 4a66f0b7d... New fileset for googlecloud firewall logs (#14553)
    enabled: true

    # Google Cloud project ID.
    var.project_id: my-gcp-project-id

    # Google Pub/Sub topic containing firewall logs. Stackdriver must be
    # configured to use this topic as a sink for firewall logs.
<<<<<<< HEAD
    var.topic: googlecloud-vpc-audit

    # Google Pub/Sub subscription for the topic. Filebeat will create this
    # subscription if it does not exist.
    var.subscription_name: filebeat-googlecloud-audit
=======
    var.topic: googlecloud-vpc-firewall

    # Google Pub/Sub subscription for the topic. Filebeat will create this
    # subscription if it does not exist.
    var.subscription_name: filebeat-googlecloud-firewall-sub
>>>>>>> 4a66f0b7d... New fileset for googlecloud firewall logs (#14553)

    # Credentials file for the service account with authorization to read from
    # the subscription.
    var.credentials_file: ${path.config}/gcp-service-account-xyz.json
