[
    {
        "@timestamp": "2019-12-19T00:49:36.086Z",
        "cloud.project.id": "elastic-beats",
        "event.action": "GetResourceBillingInfo",
        "event.dataset": "gcp.audit",
        "event.id": "-uihnmjctwo",
        "event.kind": "event",
        "event.module": "gcp",
        "event.outcome": "success",
        "fileset.name": "audit",
        "googlecloud.audit.authentication_info.principal_email": "xxx@xxx.xxx",
        "googlecloud.audit.authorization_info": [
            {
                "granted": true,
                "permission": "resourcemanager.projects.get",
                "resource": "projects/elastic-beats",
                "resource_attributes": {}
            }
        ],
        "googlecloud.audit.method_name": "GetResourceBillingInfo",
        "googlecloud.audit.request.proto_name": "type.googleapis.com/google.internal.cloudbilling.billingaccount.v1.GetResourceBillingInfoRequest",
        "googlecloud.audit.request.resource_name": "projects/189716325846",
        "googlecloud.audit.request_metadata.caller_ip": "192.168.1.1",
        "googlecloud.audit.resource_name": "projects/elastic-beats",
        "googlecloud.audit.service_name": "cloudbilling.googleapis.com",
        "googlecloud.audit.type": "type.googleapis.com/google.cloud.audit.AuditLog",
        "input.type": "log",
        "log.logger": "projects/elastic-beats/logs/cloudaudit.googleapis.com%2Fdata_access",
        "log.offset": 0,
        "service.name": "cloudbilling.googleapis.com",
        "service.type": "gcp",
        "source.ip": "192.168.1.1",
        "tags": [
            "forwarded"
        ],
        "user.email": "xxx@xxx.xxx"
    },
    {
        "@timestamp": "2019-12-19T00:45:51.228Z",
        "cloud.project.id": "elastic-beats",
        "event.action": "beta.compute.machineTypes.aggregatedList",
        "event.dataset": "gcp.audit",
        "event.id": "-h6onuze1h7dg",
        "event.kind": "event",
        "event.module": "gcp",
        "event.outcome": "failure",
        "fileset.name": "audit",
        "googlecloud.audit.authentication_info.principal_email": "xxx@xxx.xxx",
        "googlecloud.audit.authorization_info": [
            {
                "granted": false,
                "permission": "compute.machineTypes.list",
                "resource_attributes": {
                    "name": "projects/elastic-beats",
                    "service": "resourcemanager",
                    "type": "resourcemanager.projects"
                }
            }
        ],
        "googlecloud.audit.method_name": "beta.compute.machineTypes.aggregatedList",
        "googlecloud.audit.num_response_items": 71,
        "googlecloud.audit.request.proto_name": "type.googleapis.com/compute.machineTypes.aggregatedList",
        "googlecloud.audit.request_metadata.caller_ip": "192.168.1.1",
        "googlecloud.audit.request_metadata.caller_supplied_user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:71.0) Gecko/20100101 Firefox/71.0,gzip(gfe),gzip(gfe)",
        "googlecloud.audit.resource_location.current_locations": [
            "global"
        ],
        "googlecloud.audit.resource_name": "projects/elastic-beats/global/machineTypes",
        "googlecloud.audit.service_name": "compute.googleapis.com",
        "googlecloud.audit.type": "type.googleapis.com/google.cloud.audit.AuditLog",
        "input.type": "log",
        "log.logger": "projects/elastic-beats/logs/cloudaudit.googleapis.com%2Fdata_access",
        "log.offset": 945,
        "service.name": "compute.googleapis.com",
        "service.type": "gcp",
        "source.ip": "192.168.1.1",
        "tags": [
            "forwarded"
        ],
        "user.email": "xxx@xxx.xxx",
        "user_agent.device.name": "Mac",
        "user_agent.name": "Firefox",
        "user_agent.original": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:71.0) Gecko/20100101 Firefox/71.0,gzip(gfe),gzip(gfe)",
        "user_agent.os.full": "Mac OS X 10.15",
        "user_agent.os.name": "Mac OS X",
        "user_agent.os.version": "10.15",
        "user_agent.version": "71.0."
    },
    {
        "@timestamp": "2019-12-19T00:44:25.051Z",
        "cloud.project.id": "elastic-beats",
        "event.action": "beta.compute.instances.aggregatedList",
        "event.dataset": "gcp.audit",
        "event.id": "yonau2dg2zi",
        "event.kind": "event",
        "event.module": "gcp",
        "event.outcome": "success",
        "fileset.name": "audit",
        "googlecloud.audit.authentication_info.principal_email": "xxx@xxx.xxx",
        "googlecloud.audit.authorization_info": [
            {
                "granted": true,
                "permission": "compute.instances.list",
                "resource_attributes": {
                    "name": "projects/elastic-beats",
                    "service": "resourcemanager",
                    "type": "resourcemanager.projects"
                }
            }
        ],
        "googlecloud.audit.method_name": "beta.compute.instances.aggregatedList",
        "googlecloud.audit.num_response_items": 61,
        "googlecloud.audit.request.proto_name": "type.googleapis.com/compute.instances.aggregatedList",
        "googlecloud.audit.request_metadata.caller_ip": "192.168.1.1",
        "googlecloud.audit.request_metadata.caller_supplied_user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:71.0) Gecko/20100101 Firefox/71.0,gzip(gfe),gzip(gfe)",
        "googlecloud.audit.resource_location.current_locations": [
            "global"
        ],
        "googlecloud.audit.resource_name": "projects/elastic-beats/global/instances",
        "googlecloud.audit.response.details.group": "batch",
        "googlecloud.audit.response.details.kind": "jobs",
        "googlecloud.audit.response.details.name": "gsuite-exporter-1589294700",
        "googlecloud.audit.response.details.uid": "2beff34a-945f-11ea-bacf-42010a80007f",
        "googlecloud.audit.response.proto_name": "core.k8s.io/v1.Status",
        "googlecloud.audit.response.status": "Success",
        "googlecloud.audit.service_name": "compute.googleapis.com",
        "googlecloud.audit.type": "type.googleapis.com/google.cloud.audit.AuditLog",
        "input.type": "log",
        "log.logger": "projects/elastic-beats/logs/cloudaudit.googleapis.com%2Fdata_access",
        "log.offset": 2252,
        "service.name": "compute.googleapis.com",
        "service.type": "gcp",
        "source.ip": "192.168.1.1",
        "tags": [
            "forwarded"
        ],
        "user.email": "xxx@xxx.xxx",
        "user_agent.device.name": "Mac",
        "user_agent.name": "Firefox",
        "user_agent.original": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:71.0) Gecko/20100101 Firefox/71.0,gzip(gfe),gzip(gfe)",
        "user_agent.os.full": "Mac OS X 10.15",
        "user_agent.os.name": "Mac OS X",
        "user_agent.os.version": "10.15",
        "user_agent.version": "71.0."
    },
    {
        "@timestamp": "2019-12-19T00:44:25.051Z",
        "cloud.project.id": "elastic-beats",
        "event.action": "beta.compute.instances.aggregatedList",
        "event.dataset": "gcp.audit",
        "event.id": "yonau3dc2zi",
        "event.kind": "event",
        "event.module": "gcp",
        "event.outcome": "failure",
        "fileset.name": "audit",
        "googlecloud.audit.authentication_info.principal_email": "xxx@xxx.xxx",
        "googlecloud.audit.authorization_info": [
            {
                "permission": "compute.instances.list",
                "resource_attributes": {
                    "name": "projects/elastic-beats",
                    "service": "resourcemanager",
                    "type": "resourcemanager.projects"
                }
            }
        ],
        "googlecloud.audit.method_name": "beta.compute.instances.aggregatedList",
        "googlecloud.audit.num_response_items": 61,
        "googlecloud.audit.request.proto_name": "type.googleapis.com/compute.instances.aggregatedList",
        "googlecloud.audit.request_metadata.caller_ip": "192.168.1.1",
        "googlecloud.audit.request_metadata.caller_supplied_user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:71.0) Gecko/20100101 Firefox/71.0,gzip(gfe),gzip(gfe)",
        "googlecloud.audit.resource_location.current_locations": [
            "global"
        ],
        "googlecloud.audit.resource_name": "projects/elastic-beats/global/instances",
        "googlecloud.audit.service_name": "compute.googleapis.com",
        "googlecloud.audit.status.code": 7,
        "googlecloud.audit.status.message": "PERMISSION_DENIED",
        "googlecloud.audit.type": "type.googleapis.com/google.cloud.audit.AuditLog",
        "input.type": "log",
        "log.logger": "projects/elastic-beats/logs/cloudaudit.googleapis.com%2Fdata_access",
        "log.offset": 3776,
        "service.name": "compute.googleapis.com",
        "service.type": "gcp",
        "source.ip": "192.168.1.1",
        "tags": [
            "forwarded"
        ],
        "user.email": "xxx@xxx.xxx",
        "user_agent.device.name": "Mac",
        "user_agent.name": "Firefox",
        "user_agent.original": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:71.0) Gecko/20100101 Firefox/71.0,gzip(gfe),gzip(gfe)",
        "user_agent.os.full": "Mac OS X 10.15",
        "user_agent.os.name": "Mac OS X",
        "user_agent.os.version": "10.15",
        "user_agent.version": "71.0."
    },
    {
        "@timestamp": "2020-08-05T21:07:30.974Z",
        "cloud.project.id": "elastic-siem",
        "event.action": "io.k8s.authorization.v1beta1.subjectaccessreviews.create",
        "event.dataset": "gcp.audit",
        "event.id": "87efd529-6349-45d2-b905-fc607e6c5d3b",
        "event.kind": "event",
        "event.module": "gcp",
        "event.outcome": "success",
        "fileset.name": "audit",
        "googlecloud.audit.authentication_info.principal_email": "system:serviceaccount:cert-manager:cert-manager-webhook",
        "googlecloud.audit.authorization_info": [
            {
                "granted": true,
                "permission": "io.k8s.authorization.v1beta1.subjectaccessreviews.create",
                "resource": "authorization.k8s.io/v1beta1/subjectaccessreviews"
            }
        ],
        "googlecloud.audit.method_name": "io.k8s.authorization.v1beta1.subjectaccessreviews.create",
        "googlecloud.audit.request.proto_name": "authorization.k8s.io/v1beta1.SubjectAccessReview",
        "googlecloud.audit.request_metadata.caller_ip": "10.11.12.13",
        "googlecloud.audit.request_metadata.caller_supplied_user_agent": "webhook/v0.0.0 (linux/amd64) kubernetes/$Format",
        "googlecloud.audit.resource_name": "authorization.k8s.io/v1beta1/subjectaccessreviews",
        "googlecloud.audit.response.proto_name": "authorization.k8s.io/v1beta1.SubjectAccessReview",
        "googlecloud.audit.response.status": "map[allowed:true reason:RBAC: allowed by ClusterRoleBinding \"system:discovery\" of ClusterRole \"system:discovery\" to Group \"system:authenticated\"]",
        "googlecloud.audit.service_name": "k8s.io",
        "googlecloud.audit.status.code": 0,
        "googlecloud.audit.type": "type.googleapis.com/google.cloud.audit.AuditLog",
        "input.type": "log",
        "log.logger": "projects/foo/logs/cloudaudit.googleapis.com%2Fdata_access",
        "log.offset": 5100,
        "service.name": "k8s.io",
        "service.type": "gcp",
        "source.ip": "10.11.12.13",
        "tags": [
            "forwarded"
        ],
        "user.email": "system:serviceaccount:cert-manager:cert-manager-webhook",
        "user_agent.device.name": "Other",
        "user_agent.name": "Other",
        "user_agent.original": "webhook/v0.0.0 (linux/amd64) kubernetes/$Format",
        "user_agent.os.name": "Linux"
    },
    {
        "@timestamp": "2020-08-05T21:59:26.456Z",
        "cloud.project.id": "foo",
        "event.action": "v1.compute.images.insert",
        "event.dataset": "gcp.audit",
        "event.id": "v2spcwdzmc2",
        "event.kind": "event",
        "event.module": "gcp",
        "event.outcome": "success",
        "fileset.name": "audit",
        "googlecloud.audit.authentication_info.principal_email": "user@mycompany.com",
        "googlecloud.audit.authorization_info": [
            {
                "granted": true,
                "permission": "compute.images.create",
                "resource_attributes": {
                    "name": "projects/foo/global/images/windows-server-2016-v20200805",
                    "service": "compute",
                    "type": "compute.images"
                }
            }
        ],
        "googlecloud.audit.method_name": "v1.compute.images.insert",
        "googlecloud.audit.request.name": "windows-server-2016-v20200805",
        "googlecloud.audit.request.proto_name": "type.googleapis.com/compute.images.insert",
        "googlecloud.audit.request_metadata.caller_ip": "1.2.3.4",
        "googlecloud.audit.request_metadata.caller_supplied_user_agent": "google-cloud-sdk gcloud/290.0.1 command/gcloud.compute.images.create invocation-id/032752ad0fa44b4ea951951d2deef6a3 environment/None environment-version/None interactive/True from-script/False python/2.7.17 term/xterm-256color (Macintosh; Intel Mac OS X 19.6.0),gzip(gfe)",
        "googlecloud.audit.resource_location.current_locations": [
            "eu"
        ],
        "googlecloud.audit.resource_name": "projects/foo/global/images/windows-server-2016-v20200805",
        "googlecloud.audit.response.proto_name": "type.googleapis.com/operation",
        "googlecloud.audit.response.status": "RUNNING",
        "googlecloud.audit.service_name": "compute.googleapis.com",
        "googlecloud.audit.type": "type.googleapis.com/google.cloud.audit.AuditLog",
        "input.type": "log",
        "log.logger": "projects/foo/logs/cloudaudit.googleapis.com%2Factivity",
        "log.offset": 7530,
        "service.name": "compute.googleapis.com",
        "service.type": "gcp",
        "source.geo.city_name": "Moscow",
        "source.geo.continent_name": "Europe",
        "source.geo.country_iso_code": "RU",
        "source.geo.country_name": "Russia",
        "source.geo.location.lat": 55.7527,
        "source.geo.location.lon": 37.6172,
        "source.geo.region_iso_code": "RU-MOW",
        "source.geo.region_name": "Moscow",
        "source.ip": "1.2.3.4",
        "tags": [
            "forwarded"
        ],
        "user.email": "user@mycompany.com",
        "user_agent.device.name": "Mac",
        "user_agent.name": "Other",
        "user_agent.original": "google-cloud-sdk gcloud/290.0.1 command/gcloud.compute.images.create invocation-id/032752ad0fa44b4ea951951d2deef6a3 environment/None environment-version/None interactive/True from-script/False python/2.7.17 term/xterm-256color (Macintosh; Intel Mac OS X 19.6.0),gzip(gfe)",
        "user_agent.os.full": "Mac OS X 19.6.0",
        "user_agent.os.name": "Mac OS X",
        "user_agent.os.version": "19.6.0"
    },
    {
        "@timestamp": "2020-08-05T16:56:40.428Z",
        "cloud.instance.id": "590261181",
        "cloud.project.id": "foo",
        "event.action": "beta.compute.instances.stop",
        "event.dataset": "gcp.audit",
        "event.id": "-c7ctxmd2zab",
        "event.kind": "event",
        "event.module": "gcp",
        "event.outcome": "unknown",
        "fileset.name": "audit",
        "googlecloud.audit.authentication_info.principal_email": "user@mycompany.com",
        "googlecloud.audit.method_name": "beta.compute.instances.stop",
        "googlecloud.audit.request.proto_name": "type.googleapis.com/compute.instances.stop",
        "googlecloud.audit.request_metadata.caller_ip": "2.3.4.5",
        "googlecloud.audit.request_metadata.caller_supplied_user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:79.0) Gecko/20100101 Firefox/79.0,gzip(gfe),gzip(gfe)",
        "googlecloud.audit.resource_name": "projects/foo/zones/us-central1-a/instances/win10-test",
        "googlecloud.audit.service_name": "compute.googleapis.com",
        "googlecloud.audit.type": "type.googleapis.com/google.cloud.audit.AuditLog",
        "input.type": "log",
        "log.logger": "projects/foo/logs/cloudaudit.googleapis.com%2Factivity",
        "log.offset": 9946,
        "service.name": "compute.googleapis.com",
        "service.type": "gcp",
        "source.as.number": 3215,
        "source.as.organization.name": "Orange",
        "source.geo.city_name": "Clermont-Ferrand",
        "source.geo.continent_name": "Europe",
        "source.geo.country_iso_code": "FR",
        "source.geo.country_name": "France",
        "source.geo.location.lat": 45.7838,
        "source.geo.location.lon": 3.0966,
        "source.geo.region_iso_code": "FR-63",
        "source.geo.region_name": "Puy-de-D\u00f4me",
        "source.ip": "2.3.4.5",
        "tags": [
            "forwarded"
        ],
        "user.email": "user@mycompany.com",
        "user_agent.device.name": "Mac",
        "user_agent.name": "Firefox",
        "user_agent.original": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:79.0) Gecko/20100101 Firefox/79.0,gzip(gfe),gzip(gfe)",
        "user_agent.os.full": "Mac OS X 10.15",
        "user_agent.os.name": "Mac OS X",
        "user_agent.os.version": "10.15",
        "user_agent.version": "79.0."
    }
]