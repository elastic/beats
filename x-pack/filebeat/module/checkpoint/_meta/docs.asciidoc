[role="xpack"]

:modulename: checkpoint
:has-dashboards: false


== Checkpoint module
beta[]

This is a module for Checkpoint firewall logs. It supports logs from the Log Exporter in the Syslog format.

include::../include/gs-link.asciidoc[]


[float]
=== Compatibility

This module has been tested against Checkpoint Log Exporter on R80.X but should also work with R77.30.

include::../include/configuring-intro.asciidoc[]

:fileset_ex: firewall

include::../include/config-option-intro.asciidoc[]

==== `firewall` fileset settings

Example config:

[source,yaml]
----
- module: checkpoint
  firewall:
    var.syslog_host: 0.0.0.0
    var.syslog_port: 9001
----

include::../include/var-paths.asciidoc[]

*`var.syslog_host`*::

The interface to listen to UDP based syslog traffic. Defaults to localhost.
Set to 0.0.0.0 to bind to all available interfaces.

*`var.syslog_port`*::

The UDP port to listen for syslog traffic. Defaults to 9001.

[float]
==== Check Point devices

This module will parse Check Point Syslog data as documented in:
https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&solutionid=sk144192[Checkpoint Log Fields Description.]

Check Point Syslog extensions are mapped as follows:
[options="header"]
|=======================================================================================================================
| Check Point Fields         | CEF Label value             | ECS Fields               | Non-ECS Field                  |
| cp_app_risk                | -                           | event.risk_score         | checkpoint.app_risk            |
| cp_severity                | -                           | event.severity           | checkpoint.severity            |
| baseEventCount             | -                           | -                        | checkpoint.event_count         |
| deviceExternalId           | -                           | observer.type            | -                              |
| deviceFacility             | -                           | observer.type            | -                              |
| deviceInboundInterface     | -                           | observer.ingress.interface.name | -                       |
| deviceOutboundInterface    | -                           | observer.egress.interface.name | -                        |
| externalId                 | -                           | -                        | checkpoint.uuid                |
| fileHash                   | -                           | file.hash.{md5,sha1}     | -                              |
| reason                     | -                           | -                        | checkpoint.termination_reason  |
| requestCookies             | -                           | -                        | checkpoint.cookie              |
| sourceNtDomain             | -                           | dns.question.name        | -                              |
| Signature                  | -                           | vulnerability.id         | -                              |
| Recipient                  | -                           | destination.user.email   | -                              |
| Sender                     | -                           | source.user.email        | -                              |
| deviceCustomFloatingPoint1 | update version              | observer.version         | -                              |
| deviceCustomIPv6Address2   | source ipv6 address         | source.ip                | -                              |
| deviceCustomIPv6Address3   | destination ipv6 address    | destination.ip           | -                              |
|=======================================================================================================================

:modulename!: