{{ if eq .input "mongodbatlas" }}

type: mongodbatlas
public_key: {{ .public_key }}
private_key: {{ .private_key }}
log_name: ["mongos-audit-log.gz", "mongodb-audit-log.gz"]
group_id:
{{ range .group_id }}
  - {{ . }}
{{ end }}

{{ else if eq .input "file" }}

type: log
paths:
{{ range $i, $path := .paths }}
  - {{$path}}
{{ end }}
exclude_files: [".gz$"]

{{ end }}

processors:
  - script:
      lang: javascript
      id: mongodb_atlas_script
      file: ${path.home}/module/mongodb_atlas/audit/config/pipeline.js
  - timestamp:
      field: json.timestamp
      layouts:
        - UNIX
  - drop_fields:
      fields: [json]
  - add_fields:
      target: ''
      fields:
        ecs.version: 1.9.0
