description: Pipeline for OKTA system logs.

processors:
  - user_agent:
      field: user_agent.original
      ignore_missing: true
  - geoip:
      field: source.ip
      target_field: source.geo
      ignore_missing: true
  - geoip:
      field: destination.ip
      target_field: source.geo
      ignore_missing: true
  
on_failure:
  - set:
      field: error.message
      value: '{{ _ingest.on_failure_message }}'
