# type: log
# paths:
# {{ range $i, $path := .paths }}
#   - {{$path}}
# {{ end }}
type: docker
containers.ids:
  - '*'
tags: {{.tags}}
processors:
  - drop_event.when.not.and:
      - equals:
        kubernetes.labels.k8s-app: kube-dns
      - equals:
        kubernetes.namespace: kube-system
  - dissect:
      tokenizer: "%{timestamp} [%{log_level}] %{client}:%{port} - %{id} \"%{qtype} %{qclass} %{qname} %{proto} %{size} %{dnssec_ok} %{bufsize}\" %{rcode} %{rflags} %{rsize} %{duration}s"
      field: "message"
      target_prefix: "coredns"
