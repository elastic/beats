# type: log
# paths:
# {{ range $i, $path := .paths }}
#   - {{$path}}
# {{ end }}
type: docker
containers.ids:
  - '*'
include_lines: ['^ACCESS']
tags: {{.tags}}
processors:
  # - drop_event.when.not:
  #     - equals:
  #         kubernetes.labels.service: ambassador
  - dissect:
      tokenizer: "%{log_type} [%{timestamp}] \"%{method} %{path} %{proto}\" %{response_code} %{response_flags} %{bytes_received} %{bytes_sent} %{duration} %{upstream_service_time} \"%{forwarded_for}\" \"%{http_user_agent}\" \"%{request_id}\" \"%{authority}\" \"%{upstream_host}:%{upstream_port}\""
      field: "message"
      target_prefix: "envoy"
  
