type: log
paths:
{{ range $i, $path := .paths }}
  - {{$path}}
{{ end }}
include_lines: ['^ACCESS']
json.keys_under_root: true
json.message_key: message
tags: {{.tags}}
processors:
  - dissect:
      tokenizer: "%{log_type} [%{timestamp}] \"%{method} %{path} %{proto}\" %{response_code} %{response_flags} %{bytes_received} %{bytes_sent} %{duration} %{upstream_service_time} \"%{forwarded_for}\" \"%{http_user_agent}\" \"%{request_id}\" \"%{authority}\" \"%{upstream_host}:%{upstream_port}\""
      field: "message"
      target_prefix: "envoy"
  - drop_fields: 
      fields: [time]
  
