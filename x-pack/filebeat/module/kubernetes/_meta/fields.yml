- key: kubernetes
  title: Kubernetes
  description: >
    Module for handling logs produced by Kubenetes pods
  fields:
  - name: coredns
    type: group
    description: >
      Fields from coredns logs after normalization
    fields:
    - name: duration
      type: double

    - name: client
      type: ip

    - name: size
      type: integer

    - name: dnssec_ok
      type: boolean

    - name: proto
      type: keyword 

    - name: qclass
      type: keyword

    - name: rsize
      type: integer

    - name: log_level
      type: keyword

    - name: id
      type: keyword

    - name: rcode
      type: keyword

    - name: port
      type: integer

    - name: bufsize
      type: integer

    - name: qtype
      type: keyword

    - name: rflags
      type: keyword
      description: >
        coredns response flags

    - name: qname
      type: keyword
      description: >
        coredns query name

    - name: message
      type: text
      description: >
        coredns original log message

  - name: kubernetes
    type: group
    description: >
      Kubernetes meta fields
    fields:
    - name: replicaset
      type: group
      fields:
      - name: name
        type: keyword

  - name: envoy
    type: group
    description: >
      Fields from envoy proxy logs after normalization
    fields:
    - name: log_type
      type: keyword
      description: >
        Envoy log type, normally ACCESS

    - name: method
      type: keyword

    - name: path
      type: keyword

    - name: proto 
      type: keyword

    - name: response_code
      type: integer

    - name: response_flags
      type: keyword

    - name: bytes_received
      type: long

    - name: bytes_sent
      type: long

    - name: duration
      type: double 

    - name: upstream_service_time
      type: double

    - name: forwarded_for
      type: keyword

    - name: http_user_agent
      type: keyword

    - name: request_id
      type: keyword

    - name: authority
      type: keyword

    - name: upstream_host 
      type: ip

    - name: upstream_port
      type: integer

    - name: message
      type: text
      description: >
        envoy original log message
