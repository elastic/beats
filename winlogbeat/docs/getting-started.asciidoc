[id="{beatname_lc}-installation-configuration"]
== {beatname_uc} quick start: installation and configuration

//TODO: Needs more work. Just getting the build working.

++++
<titleabbrev>{beatname_uc} quick start</titleabbrev>
++++

This guide describes how to get started quickly with Windows log collection.
You'll learn how to:

* install {beatname_uc} on each system you want to monitor
* specify the location of your log files
* parse log data into fields and send it to {es}
* visualize the log data in {kib}

[float]
=== Before you begin

You need {es} for storing and searching your data, and {kib} for visualizing and
managing it.

// TODO: We might want to provide the instructions for spinning up a deployment
// here. See
// https://github.com/elastic/docs/pull/1815/files#diff-934228d98950ff95c8c53444966daeaeR10
// Or link to the topic that's available for cloud.

include::{libbeat-dir}/tab-widgets/spinup-stack-widget.asciidoc[]

[float]
[[installation]]
=== Step 1: Install {beatname_uc}

. Download the {beatname_uc} zip file from the
https://www.elastic.co/downloads/beats/winlogbeat[downloads page].
. Extract the contents into `C:\Program Files`.
. Rename the `winlogbeat-<version>` directory to `Winlogbeat`.
. Open a PowerShell prompt as an Administrator (right-click on the PowerShell
icon and select Run As Administrator).
. From the PowerShell prompt, run the following commands to install the service.

["source","sh",subs="attributes,callouts"]
------------------------------------------------
PS C:\Users\Administrator> cd 'C:\Program Files\Winlogbeat'
PS C:\Program Files\Winlogbeat> .\install-service-winlogbeat.ps1

Security warning
Run only scripts that you trust. While scripts from the internet can be useful,
this script can potentially harm your computer. If you trust this script, use
the Unblock-File cmdlet to allow the script to run without this warning message.
Do you want to run C:\Program Files\Winlogbeat\install-service-winlogbeat.ps1?
[D] Do not run  [R] Run once  [S] Suspend  [?] Help (default is "D"): R

Status   Name               DisplayName
------   ----               -----------
Stopped  winlogbeat         winlogbeat
------------------------------------------------

NOTE: If script execution is disabled on your system, you need to set the
execution policy for the current session to allow the script to run. For example:
`PowerShell.exe -ExecutionPolicy UnRestricted -File .\install-service-winlogbeat.ps1`.

Before starting {beatname_uc}, you should look at the configuration options in the
configuration file, for example `C:\Program Files\Winlogbeat\winlogbeat.yml`.
Thereâ€™s also a full example configuration file called `winlogbeat.reference.yml` that
shows all non-deprecated options. For more information about these options, see
<<configuring-howto-winlogbeat>>.

[float]
[[set-connection]]
=== Step 2: Set the connection information

include::{libbeat-dir}/shared/connecting-to-es.asciidoc[]

[float]
[[configuration]]
=== Step 3: Configure {beatname_uc}

In `winlogbeat.yml`, configure the event logs that you want to monitor.

. Under `winlogbeat.event_log`, specify a list of event logs to monitor. By
default, {beatname_uc} monitors application, security, and system logs.
+
[source,yaml]
----------------------------------------------------------------------
winlogbeat.event_logs:
  - name: Application
  - name: Security
  - name: System
----------------------------------------------------------------------
+
To obtain a list of available event logs, run `Get-EventLog *` in PowerShell.
For more information about this command, see the configuration details for
<<configuration-winlogbeat-options-event_logs-name,event_logs.name>>.

. After you save your configuration file, test it with the following command.
+
[source,shell]
----------------------------------------------------------------------
PS C:\Program Files\Winlogbeat> .\winlogbeat.exe test config -c .\winlogbeat.yml -e
----------------------------------------------------------------------

//REVIEWERS: I've removed the logging section from the example shown above
//because I don't think it's necessary and might confuse users.

[float]
[[config-winlogbeat-logstash]]
=== Step 4: Configure {beatname_uc} to use {ls}

//REVIEWERS: Do we want to show the LS steps here or point users to ingest node
//instead?

include::{libbeat-outputs-dir}/logstash/docs/logstash.asciidoc[tag=shared-logstash-config]

[float]
[[setup-assets]]
=== Step 5: Set up assets

{beatname_uc} comes with predefined assets for parsing, indexing, and
visualizing your data. To load these assets:

. Make sure the user specified in +{beatname_lc}.yml+ has the
<<privileges-to-setup-beats,privileges and roles>> needed to set up
{beatname_uc}.

. From the installation directory, run:
+
--
include::{libbeat-dir}/tab-widgets/setup.asciidoc[tag=win]
--

This step loads the recommended index template for writing to {es}
and deploys the sample dashboards for visualizing the data in {kib}.

[TIP]
=====
A connection to {es} (or {ess}) is required to set up the initial
environment. If you're using a different output, such as {ls}, see
<<load-template-manually>> and <<load-kibana-dashboards>>.
=====

[float]
[[start]]
=== Step 6: Start {beatname_uc}

Start the {beatname_uc} service with the following command. If you are accessing a
secured Elasticsearch cluster, make sure you've configured credentials as
described in <<{beatname_lc}-configuration>>.

// tag::start-step[]
[source,shell]
----------------------------------------------------------------------
PS C:\Program Files\Winlogbeat> Start-Service winlogbeat
----------------------------------------------------------------------

{beatname_uc} should now be running. If you used the configuration described here,
then you can view the log file at `C:\ProgramData\winlogbeat\Logs\winlogbeat`.

You can view the status of the service and control it from the Services
management console in Windows. To launch the management console, run
this command:

[source,shell]
----------------------------------------------------------------------
PS C:\Program Files\Winlogbeat> services.msc
----------------------------------------------------------------------
// end::start-step[]

[float]
==== Stop {beatname_uc}

Stop the {beatname_uc} service with the following command:

[source,shell]
----------------------------------------------------------------------
PS C:\Program Files\Winlogbeat> Stop-Service winlogbeat
----------------------------------------------------------------------

[float]
[[view-data]]
=== Step 7: View your data in {kib}

include::{libbeat-dir}/shared/opendashboards.asciidoc[tag=open-dashboards-intro]

include::{libbeat-dir}/shared/opendashboards.asciidoc[tag=open-dashboards]

[role="screenshot"]
image::./images/winlogbeat-dashboard.png[{beatname_uc} statistics]

[float]
=== What's next?

include::{libbeat-dir}/shared/obs-apps.asciidoc[tag=obs-intro]

include::{libbeat-dir}/shared/obs-apps.asciidoc[tag=add-metrics]

include::{libbeat-dir}/shared/obs-apps.asciidoc[tag=add-logs]

include::{libbeat-dir}/shared/obs-apps.asciidoc[tag=add-uptime]

include::{libbeat-dir}/shared/obs-apps.asciidoc[tag=add-apm]

include::{libbeat-dir}/shared/obs-apps.asciidoc[tag=add-security]

include::{libbeat-dir}/shared/obs-apps.asciidoc[tag=obs-apps]


