#!/usr/bin/env bash

set -euo pipefail

source .buildkite/filebeat/scripts/common.sh

if [[ "$BUILDKITE_PIPELINE_SLUG" == "filebeat" ]]; then
  export WORKSPACE="$(pwd)"

  prepare_win

  if [[ -z "${GOLANG_VERSION-""}" ]]; then
    export GOLANG_VERSION=$(cat "${WORKSPACE}/.go-version")
  fi

  if [[ "$BUILDKITE_STEP_KEY" == macos* ]]; then
    ulimit -Sn 30000
  fi
fi
