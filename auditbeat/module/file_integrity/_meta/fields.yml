- key: file_integrity
  title: File Integrity
  description: These are the fields generated by the file_integrity module.
  fields:
  - name: file
    type: group
    description: File attributes.
    fields:
    - name: elf
      title: ELF Header
      description: These fields contain Linux Executable Linkable Format (ELF) metadata.
      type: group
      default_field: true
      fields:
      - name: go_imports
        level: extended
        type: flattened
        ignore_above: 1024
        description: List of imported Go language element names and types.
        default_field: false
      - name: go_imports_names_entropy
        level: extended
        type: long
        format: number
        ignore_above: 1024
        description: Shannon entropy calculation from the list of Go imports.
        default_field: false
      - name: go_imports_names_var_entropy
        level: extended
        type: long
        format: number
        ignore_above: 1024
        description: Variance for Shannon entropy calculation from the list of Go imports.
        default_field: false
      - name: go_import_hash
        level: extended
        type: keyword
        ignore_above: 1024
        short: A hash of the Go language imports in an ELF file.
        description: 'A hash of the Go language imports in an ELF file excluding standard library imports.
          An import hash can be used to fingerprint binaries even after recompilation or other
          code-level transformations have occurred, which would change more traditional hash values.

          The algorithm used to calculate the Go symbol hash and a reference implementation
          are available [here](https://github.com/elastic/toutoumomoma).'
        example: 10bddcb4cee42080f76c88d9ff964491
        default_field: false
      - name: go_stripped
        level: extended
        type: boolean
        ignore_above: 1024
        short: Whether the file is a stripped or obfuscated Go executable.
        description: Set to true if the file is a Go executable that has had its symbols stripped or obfuscated and false if an unobfuscated Go executable.
        default_field: false
      - name: imports_names_entropy
        level: extended
        type: long
        format: number
        ignore_above: 1024
        description: Shannon entropy calculation from the list of imported element names and types.
        default_field: false
      - name: imports_names_var_entropy
        level: extended
        type: long
        format: number
        ignore_above: 1024
        description: Variance for Shannon entropy calculation from the list of imported element names and types.
        default_field: false
      - name: import_hash
        level: extended
        type: keyword
        ignore_above: 1024
        short: A hash of the imports in an ELF file.
        description: 'A hash of the imports in an ELF file. An import hash can be used to
          fingerprint binaries even after recompilation or other code-level
          transformations have occurred, which would change more traditional hash values.

          This is an ELF implementation of the Windows PE imphash.'
        example: d41d8cd98f00b204e9800998ecf8427e
        default_field: false
      - name: sections.var_entropy
        level: extended
        type: long
        format: number
        ignore_above: 1024
        description: Variance for Shannon entropy calculation from the section.
        default_field: false
    - name: macho
      title: Mach-O Header
      description: These fields contain Mach object file Format (Mach-O) metadata.
      type: group
      default_field: true
      fields:
      - name: go_imports
        level: extended
        type: flattened
        ignore_above: 1024
        description: List of imported Go language element names and types.
        default_field: false
      - name: go_imports_names_entropy
        level: extended
        type: long
        format: number
        ignore_above: 1024
        description: Shannon entropy calculation from the list of Go imports.
        default_field: false
      - name: go_imports_names_var_entropy
        level: extended
        type: long
        format: number
        ignore_above: 1024
        description: Variance for Shannon entropy calculation from the list of Go imports.
        default_field: false
      - name: go_import_hash
        level: extended
        type: keyword
        ignore_above: 1024
        short: A hash of the Go language imports in a Mach-O file.
        description: 'A hash of the Go language imports in a Mach-O file excluding standard library imports.
          An import hash can be used to fingerprint binaries even after recompilation or other
          code-level transformations have occurred, which would change more traditional hash values.

          The algorithm used to calculate the Go symbol hash and a reference implementation
          are available [here](https://github.com/elastic/toutoumomoma).'
        example: 10bddcb4cee42080f76c88d9ff964491
        default_field: false
      - name: go_stripped
        level: extended
        type: boolean
        ignore_above: 1024
        short: Whether the file is a stripped or obfuscated Go executable.
        description: Set to true if the file is a Go executable that has had its symbols stripped or obfuscated and false if an unobfuscated Go executable.
        default_field: false
      - name: imports
        level: extended
        type: flattened
        ignore_above: 1024
        description: List of imported element names and types.
        default_field: false
      - name: imports_names_entropy
        level: extended
        type: long
        format: number
        ignore_above: 1024
        description: Shannon entropy calculation from the list of imported element names and types.
        default_field: false
      - name: imports_names_var_entropy
        level: extended
        type: long
        format: number
        ignore_above: 1024
        description: Variance for Shannon entropy calculation from the list of imported element names and types.
        default_field: false
      - name: import_hash
        level: extended
        type: keyword
        ignore_above: 1024
        short: A hash of the imports in a Mach-O file.
        description: 'A hash of the imports in a Mach-O file. An import hash can be used to
          fingerprint binaries even after recompilation or other code-level
          transformations have occurred, which would change more traditional hash values.

          This is a synonym for symhash.'
        example: d3ccf195b62a9279c3c19af1080497ec
        default_field: false
      - name: sections
        level: extended
        type: nested
        ignore_above: 1024
        short: Section information of the Mach-O file.
        description: 'An array containing an object for each section of the Mach-O file.

          The keys that should be present in these objects are defined by sub-fields
          underneath `macho.sections.*`.'
        default_field: false
      - name: sections.entropy
        level: extended
        type: long
        format: number
        ignore_above: 1024
        description: Shannon entropy calculation from the section.
        default_field: false
      - name: sections.var_entropy
        level: extended
        type: long
        format: number
        ignore_above: 1024
        description: Variance for Shannon entropy calculation from the section.
        default_field: false
      - name: sections.name
        level: extended
        type: keyword
        ignore_above: 1024
        description: Mach-O Section List name.
        default_field: false
      - name: sections.physical_size
        level: extended
        type: long
        format: string
        ignore_above: 1024
        description: Mach-O Section List physical size.
        default_field: false
      - name: sections.virtual_size
        level: extended
        type: long
        format: string
        ignore_above: 1024
        description: Mach-O Section List virtual size.
        default_field: false
      - name: symhash
        level: extended
        type: keyword
        ignore_above: 1024
        short: A hash of the imports in a Mach-O file.
        description: 'A hash of the imports in a Mach-O file. An import hash can be used to
          fingerprint binaries even after recompilation or other code-level
          transformations have occurred, which would change more traditional hash values.'
        example: d3ccf195b62a9279c3c19af1080497ec
        default_field: false
    - name: pe
      title: PE Header
      description: These fields contain Windows Portable Executable (PE) metadata.
      type: group
      default_field: true
      fields:
      - name: go_imports
        level: extended
        type: flattened
        ignore_above: 1024
        description: List of imported Go language element names and types.
        default_field: false
      - name: go_imports_names_entropy
        level: extended
        type: long
        format: number
        ignore_above: 1024
        description: Shannon entropy calculation from the list of Go imports.
        default_field: false
      - name: go_imports_names_var_entropy
        level: extended
        type: long
        format: number
        ignore_above: 1024
        description: Variance for Shannon entropy calculation from the list of Go imports.
        default_field: false
      - name: go_import_hash
        level: extended
        type: keyword
        ignore_above: 1024
        short: A hash of the Go language imports in a PE file.
        description: 'A hash of the Go language imports in a PE file excluding standard library imports.
          An import hash can be used to fingerprint binaries even after recompilation or other
          code-level transformations have occurred, which would change more traditional hash values.

          The algorithm used to calculate the Go symbol hash and a reference implementation
          are available [here](https://github.com/elastic/toutoumomoma).'
        example: 10bddcb4cee42080f76c88d9ff964491
        default_field: false
      - name: go_stripped
        level: extended
        type: boolean
        ignore_above: 1024
        short: Whether the file is a stripped or obfuscated Go executable.
        description: Set to true if the file is a Go executable that has had its symbols stripped or obfuscated and false if an unobfuscated Go executable.
        default_field: false
      - name: imports
        level: extended
        type: flattened
        ignore_above: 1024
        description: List of imported element names and types.
        default_field: false
      - name: imports_names_entropy
        level: extended
        type: long
        format: number
        ignore_above: 1024
        description: Shannon entropy calculation from the list of imported element names and types.
        default_field: false
      - name: imports_names_var_entropy
        level: extended
        type: long
        format: number
        ignore_above: 1024
        description: Variance for Shannon entropy calculation from the list of imported element names and types.
        default_field: false
      - name: import_hash
        level: extended
        type: keyword
        ignore_above: 1024
        short: A hash of the imports in a PE file.
        description: 'A hash of the imports in a PE file. An import hash can be used to
          fingerprint binaries even after recompilation or other code-level
          transformations have occurred, which would change more traditional hash values.

          This is a synonym for imphash.'
      - name: sections
        level: extended
        type: nested
        ignore_above: 1024
        description: 'An array containing an object for each section of the ELF file.

          The keys that should be present in these objects are defined by sub-fields
          underneath `pe.sections.*`.'
        default_field: false
      - name: sections.entropy
        level: extended
        type: long
        format: number
        ignore_above: 1024
        description: Shannon entropy calculation from the section.
        default_field: false
      - name: sections.var_entropy
        level: extended
        type: long
        format: number
        ignore_above: 1024
        description: Variance for Shannon entropy calculation from the section.
        default_field: false
      - name: sections.name
        level: extended
        type: keyword
        ignore_above: 1024
        description: PE Section List name.
        default_field: false
      - name: sections.physical_size
        level: extended
        type: long
        format: string
        ignore_above: 1024
        description: PE Section List physical size.
        default_field: false
      - name: sections.virtual_size
        level: extended
        type: long
        format: string
        ignore_above: 1024
        description: PE Section List virtual size.
        default_field: false

  - name: hash
    type: group
    description: >
      Hashes of the file. The keys are algorithm names and the values are
      the hex encoded digest values.

    fields:
    - name: blake2b_256
      type: keyword
      description: BLAKE2b-256 hash of the file.

    - name: blake2b_384
      type: keyword
      description: BLAKE2b-384 hash of the file.

    - name: blake2b_512
      type: keyword
      description: BLAKE2b-512 hash of the file.

    - name: md5
      overwrite: true
      type: keyword
      description: MD5 hash of the file.

    - name: sha1
      overwrite: true
      type: keyword
      description: SHA1 hash of the file.

    - name: sha224
      type: keyword
      description: SHA224 hash of the file.

    - name: sha256
      overwrite: true
      type: keyword
      description: SHA256 hash of the file.

    - name: sha384
      type: keyword
      description: SHA384 hash of the file.

    - name: sha3_224
      type: keyword
      description: SHA3_224 hash of the file.

    - name: sha3_256
      type: keyword
      description: SHA3_256 hash of the file.

    - name: sha3_384
      type: keyword
      description: SHA3_384 hash of the file.

    - name: sha3_512
      type: keyword
      description: SHA3_512 hash of the file.

    - name: sha512
      overwrite: true
      type: keyword
      description: SHA512 hash of the file.

    - name: sha512_224
      type: keyword
      description: SHA512/224 hash of the file.

    - name: sha512_256
      type: keyword
      description: SHA512/256 hash of the file.

    - name: xxh64
      type: keyword
      description: XX64 hash of the file.
